(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[342],{47362:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/stock/administracion",function(){return r(88800)}])},88800:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>M});var a=r(74848),o=r(96540),s=r(77037),l=r(96365);let i=e=>{let{title:t,description:r,icon:o,color:s,onClick:l}=e;return(0,a.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-6 flex flex-col items-center text-center border hover:shadow-xl transition-shadow",children:[(0,a.jsx)("div",{className:"text-4xl mb-4 ".concat(s),children:(0,a.jsx)(o,{})}),(0,a.jsx)("h3",{className:"text-xl font-semibold mb-2",children:t}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:r}),(0,a.jsx)("button",{onClick:l,className:"mt-auto bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition-colors flex items-center space-x-2",children:"Abrir"})]})};var n=r(20312),c=r.n(n),d=r(78465),m=r.n(d),u=r(29644),x=r.n(u),h=r(91642);let b=x()(m());c().setAppElement("#__next");let p=e=>{let{isOpen:t,onRequestClose:r}=e,[l,i]=(0,o.useState)([]),[n,d]=(0,o.useState)([]),[u,x]=(0,o.useState)(!1),[p,g]=(0,o.useState)(""),[f,y]=(0,o.useState)(null),[j,N]=(0,o.useState)(""),[v,C]=(0,o.useState)(""),[w,E]=(0,o.useState)({nombre:!1}),[k,S]=(0,o.useState)(!1),[_,A]=(0,o.useState)(""),[z,O]=(0,o.useState)(""),[L,B]=(0,o.useState)({nombre:!1});(0,o.useEffect)(()=>{t&&(M(),R(),D())},[t]);let M=async()=>{x(!0);try{let[e,t]=await Promise.all([(0,h.vo)(),(0,h.f2)()]);i(e.results||e),d(t.results||t)}catch(e){m().fire("Error","Error al cargar los datos de categor\xedas o art\xedculos.","error")}finally{x(!1)}},R=()=>{y(null),N(""),C(""),E({nombre:!1})},D=()=>{A(""),O(""),B({nombre:!1})},T=e=>{y(e.id),N(e.nombre),C(e.descripcion||""),E({nombre:!1})},q=async()=>{let e={nombre:!j.trim()};if(Object.values(e).some(e=>e)){E(e),m().fire("Error","Por favor, complete el nombre de la categor\xeda.","error");return}if(l.some(e=>e.nombre.toLowerCase()===j.trim().toLowerCase()&&e.id!==f)){m().fire("Error","Ya existe una categor\xeda con este nombre.","error"),E({...e,nombre:!0});return}let t={nombre:j.trim(),descripcion:v.trim()||""};try{let e=await (0,h.LO)(f,t);m().fire("\xc9xito","La categor\xeda se actualiz\xf3 correctamente.","success"),i(t=>t.map(t=>t.id===f?{...t,...e}:t)),R()}catch(e){m().fire("Error","Ocurri\xf3 un error al actualizar la categor\xeda.","error")}},I=async e=>{try{let t=n.filter(t=>t.categoria===e);if(t.length>0){let e=await b.fire({title:"Categor\xeda Asociada",html:"\n            <p>Esta categor\xeda est\xe1 asociada a ".concat(t.length,' art\xedculo(s).</p>\n            <p>\xbfDeseas cambiar la categor\xeda de estos art\xedculos a "Sin categor\xeda" o dejarla en blanco?</p>\n          '),icon:"warning",showCancelButton:!0,confirmButtonText:"Sin categor\xeda",cancelButtonText:"Dejar en blanco"});if(e.isConfirmed)await (0,h.Uu)(t.map(e=>e.id),{categoria:null});else{if(e.dismiss!==m().DismissReason.cancel)return;await (0,h.Uu)(t.map(e=>e.id),{categoria:null})}}(await b.fire({title:"\xbfEst\xe1s seguro?",text:"Esta acci\xf3n eliminar\xe1 la categor\xeda de forma permanente.",icon:"warning",showCancelButton:!0,confirmButtonText:"S\xed, eliminar",cancelButtonText:"Cancelar"})).isConfirmed&&(await (0,h.$P)(e),m().fire("\xc9xito","La categor\xeda fue eliminada correctamente.","success"),i(t=>t.filter(t=>t.id!==e)))}catch(e){m().fire("Error","Ocurri\xf3 un error al eliminar la categor\xeda.","error")}},P=async()=>{let e={nombre:!_.trim()};if(Object.values(e).some(e=>e)){B(e),m().fire("Error","Por favor, complete el nombre de la categor\xeda.","error");return}if(l.some(e=>e.nombre.toLowerCase()===_.trim().toLowerCase())){m().fire("Error","Ya existe una categor\xeda con este nombre.","error"),B({...e,nombre:!0});return}let t={nombre:_.trim(),descripcion:z.trim()||""};try{let e=await (0,h.wl)(t);m().fire("\xc9xito","Nueva categor\xeda agregada correctamente.","success"),i(t=>[...t,e]),S(!1),D()}catch(e){m().fire("Error","Ocurri\xf3 un error al crear la categor\xeda.","error")}},Q=()=>{S(!1),D()},G=(0,o.useCallback)((e,t)=>{if(!t)return e;let r=t.toLowerCase();return e.filter(e=>e.nombre.toLowerCase().includes(r)||e.descripcion.toLowerCase().includes(r))},[]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(c(),{isOpen:t,onRequestClose:r,contentLabel:"Administrar Categor\xedas",className:"bg-white rounded-lg shadow-xl w-full max-w-5xl mx-auto p-6 overflow-auto",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-800",children:"Administrar Categor\xedas"}),(0,a.jsx)("button",{onClick:r,className:"text-gray-500 hover:text-gray-700",title:"Cerrar Modal",children:(0,a.jsx)(s.QCr,{size:24})})]}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsxs)("button",{onClick:()=>{S(!0),D()},className:"flex items-center bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition-colors duration-200",title:"Crear Nueva Categor\xeda",children:[(0,a.jsx)(s.OiG,{className:"mr-2"})," Crear Categor\xeda"]})}),(0,a.jsxs)("div",{className:"mb-4 flex items-center",children:[(0,a.jsx)("input",{type:"text",placeholder:"Buscar categor\xeda...",value:p,onChange:e=>g(e.target.value),className:"p-3 border border-gray-300 rounded-md w-full shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,a.jsx)(s.dIn,{className:"ml-2 text-gray-500"})]}),u?(0,a.jsx)("p",{className:"text-center text-lg text-gray-600",children:"Cargando datos..."}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsx)("div",{className:"overflow-y-auto max-h-96",children:(0,a.jsxs)("table",{className:"min-w-full bg-white",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"bg-blue-100 sticky top-0",children:[(0,a.jsx)("th",{className:"py-3 px-6 text-left text-sm font-medium text-gray-700",children:"Nombre"}),(0,a.jsx)("th",{className:"py-3 px-6 text-left text-sm font-medium text-gray-700",children:"Descripci\xf3n"}),(0,a.jsx)("th",{className:"py-3 px-6 text-center text-sm font-medium text-gray-700",children:"Acciones"})]})}),(0,a.jsx)("tbody",{children:G(l,p).length>0?G(l,p).map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"py-3 px-6 text-sm text-gray-700",children:f===e.id?(0,a.jsx)("input",{type:"text",value:j,onChange:e=>N(e.target.value),className:"p-2 border border-gray-300 rounded-md w-full",placeholder:"Nombre de la categor\xeda"}):e.nombre}),(0,a.jsx)("td",{className:"py-3 px-6 text-sm text-gray-700",children:f===e.id?(0,a.jsx)("textarea",{value:v,onChange:e=>C(e.target.value),className:"p-2 border border-gray-300 rounded-md w-full",placeholder:"Descripci\xf3n de la categor\xeda"}):e.descripcion||"Sin descripci\xf3n"}),(0,a.jsx)("td",{className:"py-3 px-6 text-center space-x-4",children:f===e.id?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:q,className:"text-green-600 hover:text-green-800 transition-colors duration-200",title:"Guardar cambios",children:(0,a.jsx)(s.dIn,{size:18})}),(0,a.jsx)("button",{onClick:R,className:"text-red-600 hover:text-red-800 transition-colors duration-200",title:"Cancelar edici\xf3n",children:(0,a.jsx)(s.QCr,{size:18})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>T(e),className:"text-blue-600 hover:text-blue-800 transition-colors duration-200",title:"Editar Categor\xeda",children:(0,a.jsx)(s.uO9,{size:18})}),(0,a.jsx)("button",{onClick:()=>I(e.id),className:"text-red-600 hover:text-red-800 transition-colors duration-200",title:"Eliminar Categor\xeda",children:(0,a.jsx)(s.qbC,{size:18})})]})})]},e.id)):(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:"3",className:"text-center py-4 text-gray-500",children:"No se encontraron registros."})})})]})})})]}),(0,a.jsxs)(c(),{isOpen:k,onRequestClose:Q,contentLabel:"Crear Nueva Categor\xeda",className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-auto p-6 overflow-auto",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-800",children:"Crear Nueva Categor\xeda"}),(0,a.jsx)("button",{onClick:Q,className:"text-gray-500 hover:text-gray-700",title:"Cerrar Modal",children:(0,a.jsx)(s.QCr,{size:20})})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("label",{className:"block text-gray-700 mb-2",children:["Nombre",(0,a.jsx)("span",{className:"text-red-500",children:"*"}),":"]}),(0,a.jsx)("input",{type:"text",value:_,onChange:e=>A(e.target.value),className:"w-full p-2 border ".concat(L.nombre?"border-red-500":"border-gray-300"," rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"),placeholder:"Nombre de la categor\xeda"})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-gray-700 mb-2",children:"Descripci\xf3n:"}),(0,a.jsx)("textarea",{value:z,onChange:e=>O(e.target.value),className:"w-full p-2 border ".concat(L.descripcion?"border-red-500":"border-gray-300"," rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"),placeholder:"Descripci\xf3n de la categor\xeda (opcional)"})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,a.jsxs)("button",{onClick:P,className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors duration-200",children:[(0,a.jsx)(s.dIn,{className:"mr-2"}),"Guardar"]}),(0,a.jsxs)("button",{onClick:Q,className:"flex items-center px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors duration-200",children:[(0,a.jsx)(s.QCr,{className:"mr-2"}),"Cancelar"]})]})]})]})},g=x()(m());c().setAppElement("#__next");let f=e=>{let{isOpen:t,onRequestClose:r}=e,[l,i]=(0,o.useState)([]),[n,d]=(0,o.useState)([]),[m,u]=(0,o.useState)(""),[x,b]=(0,o.useState)(null),[p,f]=(0,o.useState)(""),[y,j]=(0,o.useState)(""),[N,v]=(0,o.useState)(!1),[C,w]=(0,o.useState)(null),[E,k]=(0,o.useState)([]),[S,_]=(0,o.useState)(!1),[A,z]=(0,o.useState)(""),[O,L]=(0,o.useState)("");(0,o.useEffect)(()=>{t&&(B(),M())},[t]);let B=async()=>{v(!0);try{let e=await (0,h.C7)();i(e.results||e);let t=await (0,h.f2)();d(t.results||t)}catch(e){console.error("Error cargando datos:",e),g.fire({icon:"error",title:"Error",text:"No se pudieron cargar las marcas o art\xedculos."})}finally{v(!1)}},M=()=>{u(""),b(null),f(""),j(""),w(null),k([]),z(""),L("")},R=e=>{b(e.id),f(e.nombre),j(e.descripcion||"")},D=async e=>{if(!p.trim()){g.fire({icon:"error",title:"Error",text:"El nombre no puede estar vac\xedo."});return}if(l.some(t=>t.nombre.toLowerCase()===p.trim().toLowerCase()&&t.id!==e)){g.fire({icon:"error",title:"Error",text:"Ya existe una marca con este nombre."});return}try{let t=await (0,h.Q3)(e,p.trim()||"",y.trim()||"Sin descripci\xf3n");i(l.map(r=>r.id===e?t:r)),g.fire({icon:"success",title:"\xc9xito",text:"Marca actualizada correctamente."}),b(null),f(""),j("")}catch(e){console.error("Error al actualizar la marca:",e),g.fire({icon:"error",title:"Error",text:"Ocurri\xf3 un error al actualizar la marca."})}},T=async e=>{let t=n.filter(t=>t.marca===e);if(t.length>0){k(t),w(e);return}if((await g.fire({title:"\xbfEst\xe1s seguro?",text:"\xbfDeseas eliminar esta marca?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"S\xed, eliminar",cancelButtonText:"Cancelar"})).isConfirmed)try{await (0,h.oY)(e)&&(i(l.filter(t=>t.id!==e)),g.fire({icon:"success",title:"Eliminado",text:"La marca ha sido eliminada correctamente."}))}catch(e){console.error("Error al eliminar marca:",e),g.fire({icon:"error",title:"Error",text:"Ocurri\xf3 un error al eliminar la marca."})}},q=async()=>{if(!C)return;let e=E.map(e=>"• Nombre: ".concat(e.nombre,", Stock: ").concat(e.stock_actual,", C\xf3digo Minvu: ").concat(e.codigo_minvu||"N/A",", C\xf3digo Interno: ").concat(e.codigo_interno||"N/A",", N\xba Serie: ").concat(e.numero_serie||"N/A")).join("<br/>");if((await g.fire({title:"\xbfEst\xe1s seguro?",html:"\n        <p>La marca seleccionada est\xe1 asociada a ".concat(E.length,' art\xedculo(s):</p>\n        <div style="max-height: 200px; overflow-y: auto; text-align: left;">\n          ').concat(e,"\n        </div>\n        <p>\xbfDeseas eliminarla? Los art\xedculos asociados tendr\xe1n su marca establecida en 'Sin marca'.</p>\n      "),icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"S\xed, eliminar",cancelButtonText:"Cancelar",customClass:{popup:"swal2-overflow"}})).isConfirmed)try{await (0,h.oY)(C)&&(i(l.filter(e=>e.id!==C)),g.fire({icon:"success",title:"Eliminado",text:"La marca y las asociaciones han sido eliminadas correctamente."}))}catch(e){console.error("Error al eliminar marca con art\xedculos asociados:",e),g.fire({icon:"error",title:"Error",text:"Ocurri\xf3 un error al eliminar la marca y actualizar los art\xedculos asociados."})}finally{w(null),k([])}else w(null),k([])};(0,o.useEffect)(()=>{C&&E.length>0&&q()},[C]);let I=async()=>{if(!A.trim()){g.fire({icon:"error",title:"Error",text:"El nombre de la marca no puede estar vac\xedo."});return}if(l.some(e=>e.nombre.toLowerCase()===A.trim().toLowerCase())){g.fire({icon:"error",title:"Error",text:"Ya existe una marca con este nombre."});return}try{let e=await (0,h.bu)(A.trim()||"",O.trim()||"Sin descripci\xf3n");i([...l,e]),g.fire({icon:"success",title:"\xc9xito",text:"Marca creada correctamente."}),_(!1),z(""),L("")}catch(e){console.error("Error al crear marca:",e),g.fire({icon:"error",title:"Error",text:"Ocurri\xf3 un error al crear la marca."})}},P=l.filter(e=>e.nombre.toLowerCase().includes(m.toLowerCase()));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(c(),{isOpen:t,onRequestClose:r,contentLabel:"Administrar Marcas",className:"bg-white rounded-lg shadow-xl w-full max-w-5xl mx-auto my-8 p-6 outline-none",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-800",children:"Administrar Marcas"}),(0,a.jsx)("button",{onClick:r,className:"text-gray-500 hover:text-gray-700",title:"Cerrar Modal",children:(0,a.jsx)(s.QCr,{size:24})})]}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsxs)("button",{onClick:()=>_(!0),className:"flex items-center bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600",title:"Crear Nueva Marca",children:[(0,a.jsx)(s.OiG,{className:"mr-2"})," Crear Marca"]})}),(0,a.jsxs)("div",{className:"mb-4 flex items-center",children:[(0,a.jsx)("input",{type:"text",placeholder:"Buscar Marca...",value:m,onChange:e=>u(e.target.value),className:"p-3 border border-gray-300 rounded-md w-full focus:ring-2 focus:ring-blue-500"}),(0,a.jsx)(s.KSO,{className:"ml-2 text-gray-500"})]}),N?(0,a.jsx)("p",{className:"text-center text-lg text-gray-600",children:"Cargando marcas..."}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsx)("div",{className:"overflow-y-auto max-h-96",children:(0,a.jsxs)("table",{className:"min-w-full bg-white",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"bg-blue-100 sticky top-0",children:[(0,a.jsx)("th",{className:"py-3 px-6 text-left text-sm font-medium text-gray-700",children:"Nombre"}),(0,a.jsx)("th",{className:"py-3 px-6 text-left text-sm font-medium text-gray-700",children:"Descripci\xf3n"}),(0,a.jsx)("th",{className:"py-3 px-6 text-center text-sm font-medium text-gray-700",children:"Acciones"})]})}),(0,a.jsx)("tbody",{children:P.length>0?P.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"py-3 px-6 text-sm text-gray-700",children:x===e.id?(0,a.jsx)("input",{type:"text",value:p,onChange:e=>f(e.target.value),className:"p-2 border border-gray-300 rounded-md w-full",placeholder:"Nombre de la marca"}):e.nombre}),(0,a.jsx)("td",{className:"py-3 px-6 text-sm text-gray-700",children:x===e.id?(0,a.jsx)("textarea",{value:y,onChange:e=>j(e.target.value),className:"p-2 border border-gray-300 rounded-md w-full",placeholder:"Descripci\xf3n de la marca (opcional)"}):e.descripcion||"Sin descripci\xf3n"}),(0,a.jsx)("td",{className:"py-3 px-6 text-center space-x-4",children:x===e.id?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>D(e.id),className:"text-green-600 hover:text-green-800",title:"Guardar cambios",children:(0,a.jsx)(s.dIn,{size:18})}),(0,a.jsx)("button",{onClick:()=>{b(null),f(""),j("")},className:"text-red-600 hover:text-red-800",title:"Cancelar edici\xf3n",children:(0,a.jsx)(s.QCr,{size:18})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>R(e),className:"text-blue-600 hover:text-blue-800",title:"Editar Marca",children:(0,a.jsx)(s.uO9,{size:18})}),(0,a.jsx)("button",{onClick:()=>T(e.id),className:"text-red-600 hover:text-red-800",title:"Eliminar Marca",children:(0,a.jsx)(s.qbC,{size:18})})]})})]},e.id)):(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:"3",className:"text-center py-4 text-gray-500",children:"No se encontraron marcas"})})})]})})})]}),(0,a.jsxs)(c(),{isOpen:S,onRequestClose:()=>_(!1),contentLabel:"Crear Nueva Marca",className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-auto my-8 p-6 outline-none",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-800",children:"Crear Nueva Marca"}),(0,a.jsx)("button",{onClick:()=>_(!1),className:"text-gray-500 hover:text-gray-700",title:"Cerrar Modal",children:(0,a.jsx)(s.QCr,{size:20})})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("label",{className:"block text-gray-700 mb-2",children:["Nombre",(0,a.jsx)("span",{className:"text-red-500",children:"*"}),":"]}),(0,a.jsx)("input",{type:"text",value:A,onChange:e=>z(e.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500",placeholder:"Nombre de la marca"})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-gray-700 mb-2",children:"Descripci\xf3n:"}),(0,a.jsx)("textarea",{value:O,onChange:e=>L(e.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500",placeholder:"Descripci\xf3n de la marca (opcional)"})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)("button",{onClick:I,className:"bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600",children:"Guardar"}),(0,a.jsx)("button",{onClick:()=>{_(!1),z(""),L("")},className:"bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600",children:"Cancelar"})]})]})]})},y=x()(m());c().setAppElement("#__next");let j=e=>{let{isOpen:t,onRequestClose:r}=e,[l,i]=(0,o.useState)([]),[n,d]=(0,o.useState)([]),[m,u]=(0,o.useState)(""),[x,b]=(0,o.useState)(null),[p,g]=(0,o.useState)(""),[f,j]=(0,o.useState)(""),[N,v]=(0,o.useState)(!1),[C,w]=(0,o.useState)(null),[E,k]=(0,o.useState)([]),[S,_]=(0,o.useState)(!1),[A,z]=(0,o.useState)(""),[O,L]=(0,o.useState)("");(0,o.useEffect)(()=>{t&&(B(),M())},[t]);let B=async()=>{v(!0);try{let e=await (0,h.yX)();i(e.results||e);let t=await (0,h.f2)();d(t.results||t)}catch(e){console.error("Error cargando datos:",e),y.fire({icon:"error",title:"Error",text:"No se pudieron cargar los modelos o art\xedculos."})}finally{v(!1)}},M=()=>{u(""),b(null),g(""),j(""),w(null),k([]),z(""),L("")},R=e=>{b(e.id),g(e.nombre),j(e.descripcion||"")},D=async e=>{if(!p.trim()){y.fire({icon:"error",title:"Error",text:"El nombre no puede estar vac\xedo."});return}if(l.some(t=>t.nombre.toLowerCase()===p.trim().toLowerCase()&&t.id!==e)){y.fire({icon:"error",title:"Error",text:"Ya existe un modelo con este nombre."});return}let t={nombre:p.trim()||"",descripcion:f.trim()||"Sin descripci\xf3n"};try{let r=await (0,h.MC)(e,t);i(l.map(t=>t.id===e?r:t)),y.fire({icon:"success",title:"\xc9xito",text:"Modelo actualizado correctamente."}),b(null),g(""),j("")}catch(e){if(console.error("Error al actualizar el modelo:",e),e.response&&e.response.data){let t=Object.values(e.response.data).flat();y.fire({icon:"error",title:"Error",html:t.map(e=>"<p>".concat(e,"</p>")).join("")})}else y.fire({icon:"error",title:"Error",text:"Ocurri\xf3 un error al actualizar el modelo."})}},T=async e=>{let t=n.filter(t=>t.modelo===e);if(t.length>0){k(t),w(e);return}if((await y.fire({title:"\xbfEst\xe1s seguro?",text:"\xbfDeseas eliminar este modelo?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"S\xed, eliminar",cancelButtonText:"Cancelar"})).isConfirmed)try{await (0,h.Ex)(e)&&(i(l.filter(t=>t.id!==e)),y.fire({icon:"success",title:"Eliminado",text:"El modelo ha sido eliminado correctamente."}))}catch(e){console.error("Error al eliminar modelo:",e),y.fire({icon:"error",title:"Error",text:"Ocurri\xf3 un error al eliminar el modelo."})}},q=async()=>{if(!C)return;let e=E.map(e=>"• Nombre: ".concat(e.nombre,", Stock: ").concat(e.stock_actual,", C\xf3digo Minvu: ").concat(e.codigo_minvu||"N/A",", C\xf3digo Interno: ").concat(e.codigo_interno||"N/A",", N\xba Serie: ").concat(e.numero_serie||"N/A")).join("<br/>");if((await y.fire({title:"\xbfEst\xe1s seguro?",html:"\n        <p>El modelo seleccionado est\xe1 asociado a ".concat(E.length,' art\xedculo(s):</p>\n        <div style="max-height: 200px; overflow-y: auto; text-align: left;">\n          ').concat(e,"\n        </div>\n        <p>\xbfDeseas eliminarlo? Los art\xedculos asociados tendr\xe1n su modelo establecido en 'Sin modelo'.</p>\n      "),icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"S\xed, eliminar",cancelButtonText:"Cancelar",customClass:{popup:"swal2-overflow"}})).isConfirmed)try{await (0,h.Ex)(C)&&(i(l.filter(e=>e.id!==C)),y.fire({icon:"success",title:"Eliminado",text:"El modelo y las asociaciones han sido eliminadas correctamente."}))}catch(e){console.error("Error al eliminar modelo con art\xedculos asociados:",e),y.fire({icon:"error",title:"Error",text:"Ocurri\xf3 un error al eliminar el modelo y actualizar los art\xedculos asociados."})}finally{w(null),k([])}else w(null),k([])};(0,o.useEffect)(()=>{C&&E.length>0&&q()},[C]);let I=async()=>{if(!A.trim()){y.fire({icon:"error",title:"Error",text:"El nombre del modelo no puede estar vac\xedo."});return}if(l.some(e=>e.nombre.toLowerCase()===A.trim().toLowerCase())){y.fire({icon:"error",title:"Error",text:"Ya existe un modelo con este nombre."});return}let e={nombre:A.trim()||"",descripcion:O.trim()||"Sin descripci\xf3n"};try{let t=await (0,h.Zt)(e);i([...l,t]),y.fire({icon:"success",title:"\xc9xito",text:"Modelo creado correctamente."}),_(!1),z(""),L("")}catch(e){if(console.error("Error al crear modelo:",e),e.response&&e.response.data){let t=Object.values(e.response.data).flat();y.fire({icon:"error",title:"Error",html:t.map(e=>"<p>".concat(e,"</p>")).join("")})}else y.fire({icon:"error",title:"Error",text:"Ocurri\xf3 un error al crear el modelo."})}},P=l.filter(e=>e.nombre.toLowerCase().includes(m.toLowerCase()));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(c(),{isOpen:t,onRequestClose:r,contentLabel:"Administrar Modelos",className:"bg-white rounded-lg shadow-xl w-full max-w-5xl mx-auto my-8 p-6 outline-none",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-800",children:"Administrar Modelos"}),(0,a.jsx)("button",{onClick:r,className:"text-gray-500 hover:text-gray-700",title:"Cerrar Modal",children:(0,a.jsx)(s.QCr,{size:24})})]}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsxs)("button",{onClick:()=>_(!0),className:"flex items-center bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600",title:"Crear Nuevo Modelo",children:[(0,a.jsx)(s.OiG,{className:"mr-2"})," Crear Modelo"]})}),(0,a.jsxs)("div",{className:"mb-4 flex items-center",children:[(0,a.jsx)("input",{type:"text",placeholder:"Buscar Modelo...",value:m,onChange:e=>u(e.target.value),className:"p-3 border border-gray-300 rounded-md w-full focus:ring-2 focus:ring-blue-500"}),(0,a.jsx)(s.KSO,{className:"ml-2 text-gray-500"})]}),N?(0,a.jsx)("p",{className:"text-center text-lg text-gray-600",children:"Cargando modelos..."}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsx)("div",{className:"overflow-y-auto max-h-96",children:(0,a.jsxs)("table",{className:"min-w-full bg-white",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"bg-blue-100 sticky top-0",children:[(0,a.jsx)("th",{className:"py-3 px-6 text-left text-sm font-medium text-gray-700",children:"Nombre"}),(0,a.jsx)("th",{className:"py-3 px-6 text-left text-sm font-medium text-gray-700",children:"Descripci\xf3n"}),(0,a.jsx)("th",{className:"py-3 px-6 text-center text-sm font-medium text-gray-700",children:"Acciones"})]})}),(0,a.jsx)("tbody",{children:P.length>0?P.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"py-3 px-6 text-sm text-gray-700",children:x===e.id?(0,a.jsx)("input",{type:"text",value:p,onChange:e=>g(e.target.value),className:"p-2 border border-gray-300 rounded-md w-full",placeholder:"Nombre del modelo"}):e.nombre}),(0,a.jsx)("td",{className:"py-3 px-6 text-sm text-gray-700",children:x===e.id?(0,a.jsx)("textarea",{value:f,onChange:e=>j(e.target.value),className:"p-2 border border-gray-300 rounded-md w-full",placeholder:"Descripci\xf3n del modelo (opcional)"}):e.descripcion||"Sin descripci\xf3n"}),(0,a.jsx)("td",{className:"py-3 px-6 text-center space-x-4",children:x===e.id?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>D(e.id),className:"text-green-600 hover:text-green-800",title:"Guardar cambios",children:(0,a.jsx)(s.dIn,{size:18})}),(0,a.jsx)("button",{onClick:()=>{b(null),g(""),j("")},className:"text-red-600 hover:text-red-800",title:"Cancelar edici\xf3n",children:(0,a.jsx)(s.QCr,{size:18})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>R(e),className:"text-blue-600 hover:text-blue-800",title:"Editar Modelo",children:(0,a.jsx)(s.uO9,{size:18})}),(0,a.jsx)("button",{onClick:()=>T(e.id),className:"text-red-600 hover:text-red-800",title:"Eliminar Modelo",children:(0,a.jsx)(s.qbC,{size:18})})]})})]},e.id)):(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:"3",className:"text-center py-4 text-gray-500",children:"No se encontraron modelos"})})})]})})})]}),(0,a.jsxs)(c(),{isOpen:S,onRequestClose:()=>_(!1),contentLabel:"Crear Nuevo Modelo",className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-auto my-8 p-6 outline-none",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-800",children:"Crear Nuevo Modelo"}),(0,a.jsx)("button",{onClick:()=>_(!1),className:"text-gray-500 hover:text-gray-700",title:"Cerrar Modal",children:(0,a.jsx)(s.QCr,{size:20})})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("label",{className:"block text-gray-700 mb-2",children:["Nombre",(0,a.jsx)("span",{className:"text-red-500",children:"*"}),":"]}),(0,a.jsx)("input",{type:"text",value:A,onChange:e=>z(e.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500",placeholder:"Nombre del modelo"})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-gray-700 mb-2",children:"Descripci\xf3n:"}),(0,a.jsx)("textarea",{value:O,onChange:e=>L(e.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500",placeholder:"Descripci\xf3n del modelo (opcional)"})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)("button",{onClick:I,className:"bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600",children:"Guardar"}),(0,a.jsx)("button",{onClick:()=>{_(!1),z(""),L("")},className:"bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600",children:"Cancelar"})]})]})]})},N=x()(m());c().setAppElement("#__next");let v=e=>{let{isOpen:t,onRequestClose:r}=e,[l,i]=(0,o.useState)([]),[n,d]=(0,o.useState)([]),[m,u]=(0,o.useState)(""),[x,b]=(0,o.useState)(null),[p,g]=(0,o.useState)(""),[f,y]=(0,o.useState)(""),[j,v]=(0,o.useState)(!1),[C,w]=(0,o.useState)(null),[E,k]=(0,o.useState)([]),[S,_]=(0,o.useState)(!1),[A,z]=(0,o.useState)(""),[O,L]=(0,o.useState)("");(0,o.useEffect)(()=>{t&&(B(),M())},[t]);let B=async()=>{v(!0);try{let[e,t]=await Promise.all([(0,h.jI)(),(0,h.f2)()]);i(e.results||e),d(t.results||t)}catch(e){console.error("Error cargando datos:",e),N.fire({icon:"error",title:"Error",text:"No se pudieron cargar las ubicaciones o art\xedculos."})}finally{v(!1)}},M=()=>{u(""),b(null),g(""),y(""),w(null),k([]),z(""),L("")},R=e=>{b(e.id),g(e.nombre),y(e.descripcion||"")},D=async e=>{if(!p.trim()){N.fire({icon:"error",title:"Error",text:"El nombre no puede estar vac\xedo."});return}if(l.some(t=>t.nombre.toLowerCase()===p.trim().toLowerCase()&&t.id!==e)){N.fire({icon:"error",title:"Error",text:"Ya existe una ubicaci\xf3n con este nombre."});return}try{let t=await (0,h.VH)(e,{nombre:p.trim(),descripcion:f.trim()?f.trim():"Sin descripci\xf3n"});N.fire({icon:"success",title:"\xc9xito",text:"Ubicaci\xf3n actualizada exitosamente."}),i(l.map(r=>r.id===e?t:r)),b(null),g(""),y("")}catch(e){if(console.error("Error al actualizar la ubicaci\xf3n:",e),e.response&&e.response.data){let t=e.response.data,r=Object.keys(t).map(e=>Array.isArray(t[e])?t[e].map(t=>"".concat(e,": ").concat(t)).join("<br/>"):"".concat(e,": ").concat(t[e])).join("<br/>");N.fire({icon:"error",title:"Error",html:r})}else N.fire({icon:"error",title:"Error",text:"Error al actualizar la ubicaci\xf3n."})}},T=async e=>{try{let t=n.filter(t=>t.ubicacion===e);if(t.length>0){k(t),w(e);return}(await N.fire({title:"\xbfEst\xe1s seguro?",text:"\xbfDeseas eliminar esta ubicaci\xf3n?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"S\xed, eliminar",cancelButtonText:"Cancelar"})).isConfirmed&&(await (0,h.zf)(e),N.fire({icon:"success",title:"Eliminado",text:"Ubicaci\xf3n eliminada exitosamente."}),i(l.filter(t=>t.id!==e)))}catch(e){if(console.error("Error al eliminar la ubicaci\xf3n:",e),e.response&&e.response.data){let t=e.response.data,r=Object.keys(t).map(e=>Array.isArray(t[e])?t[e].map(t=>"".concat(e,": ").concat(t)).join("<br/>"):"".concat(e,": ").concat(t[e])).join("<br/>");N.fire({icon:"error",title:"Error",html:r})}else N.fire({icon:"error",title:"Error",text:"Error al eliminar la ubicaci\xf3n."})}};(0,o.useCallback)(async()=>{if(!C)return;let e=E.map(e=>"• Nombre: ".concat(e.nombre,", Stock: ").concat(e.stock_actual,", C\xf3digo Minvu: ").concat(e.codigo_minvu||"N/A",", C\xf3digo Interno: ").concat(e.codigo_interno||"N/A",", N\xba Serie: ").concat(e.numero_serie||"N/A")).join("<br/>");if((await N.fire({title:"\xbfEst\xe1s seguro?",html:"\n        <p>La ubicaci\xf3n seleccionada est\xe1 asociada a ".concat(E.length,' art\xedculo(s):</p>\n        <div style="max-height: 200px; overflow-y: auto; text-align: left;">\n          ').concat(e,"\n        </div>\n        <p>\xbfDeseas eliminarla? Los art\xedculos asociados tendr\xe1n su ubicaci\xf3n establecida en 'Sin ubicaci\xf3n'.</p>\n      "),icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"S\xed, eliminar",cancelButtonText:"Cancelar",customClass:{popup:"swal2-overflow"}})).isConfirmed)try{await (0,h.zf)(C);let e=E.map(e=>updateArticulo(e.id,{ubicacion:null}));await Promise.all(e),N.fire({icon:"success",title:"Eliminado",text:"Ubicaci\xf3n eliminada y art\xedculos actualizados exitosamente."}),i(l.filter(e=>e.id!==C))}catch(e){console.error("Error al eliminar ubicaci\xf3n con art\xedculos asociados:",e),N.fire({icon:"error",title:"Error",text:"Error al eliminar la ubicaci\xf3n y actualizar los art\xedculos asociados."})}finally{w(null),k([])}else w(null),k([])},[C,E,l]);let q=async()=>{if(!A.trim()){N.fire({icon:"error",title:"Error",text:"El nombre de la ubicaci\xf3n no puede estar vac\xedo."});return}if(l.some(e=>e.nombre.toLowerCase()===A.trim().toLowerCase())){N.fire({icon:"error",title:"Error",text:"Ya existe una ubicaci\xf3n con este nombre."});return}try{let e=await (0,h.I1)({nombre:A.trim(),descripcion:O.trim()?O.trim():"Sin descripci\xf3n"});N.fire({icon:"success",title:"\xc9xito",text:"Ubicaci\xf3n creada exitosamente."}),i([...l,e]),_(!1),z(""),L("")}catch(e){if(console.error("Error al crear ubicaci\xf3n:",e),e.response&&e.response.data){let t=e.response.data,r=Object.keys(t).map(e=>Array.isArray(t[e])?t[e].map(t=>"".concat(e,": ").concat(t)).join("<br/>"):"".concat(e,": ").concat(t[e])).join("<br/>");N.fire({icon:"error",title:"Error",html:r})}else N.fire({icon:"error",title:"Error",text:"Error al crear la ubicaci\xf3n."})}},I=l.filter(e=>e.nombre.toLowerCase().includes(m.toLowerCase()));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(c(),{isOpen:t,onRequestClose:r,contentLabel:"Administrar Ubicaciones",className:"bg-white rounded-lg shadow-xl w-full max-w-5xl mx-auto my-8 p-6 outline-none",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-800",children:"Administrar Ubicaciones"}),(0,a.jsx)("button",{onClick:r,className:"text-gray-500 hover:text-gray-700",title:"Cerrar Modal",children:(0,a.jsx)(s.QCr,{size:24})})]}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsxs)("button",{onClick:()=>_(!0),className:"flex items-center bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition-colors duration-200",title:"Crear Nueva Ubicaci\xf3n",children:[(0,a.jsx)(s.OiG,{className:"mr-2"})," Crear Ubicaci\xf3n"]})}),(0,a.jsxs)("div",{className:"mb-4 flex items-center",children:[(0,a.jsx)("input",{type:"text",placeholder:"Buscar Ubicaci\xf3n...",value:m,onChange:e=>u(e.target.value),className:"p-3 border border-gray-300 rounded-md w-full shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,a.jsx)(s.KSO,{className:"ml-2 text-gray-500"})]}),j?(0,a.jsx)("p",{className:"text-center text-lg text-gray-600",children:"Cargando ubicaciones..."}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsx)("div",{className:"overflow-y-auto max-h-96",children:(0,a.jsxs)("table",{className:"min-w-full bg-white",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"bg-blue-100 sticky top-0",children:[(0,a.jsx)("th",{className:"py-3 px-6 text-left text-sm font-medium text-gray-700",children:"Nombre"}),(0,a.jsx)("th",{className:"py-3 px-6 text-left text-sm font-medium text-gray-700",children:"Descripci\xf3n"}),(0,a.jsx)("th",{className:"py-3 px-6 text-center text-sm font-medium text-gray-700",children:"Acciones"})]})}),(0,a.jsx)("tbody",{children:I.length>0?I.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"py-3 px-6 text-sm text-gray-700",children:x===e.id?(0,a.jsx)("input",{type:"text",value:p,onChange:e=>g(e.target.value),className:"p-2 border border-gray-300 rounded-md w-full",placeholder:"Nombre de la ubicaci\xf3n"}):e.nombre}),(0,a.jsx)("td",{className:"py-3 px-6 text-sm text-gray-700",children:x===e.id?(0,a.jsx)("textarea",{value:f,onChange:e=>y(e.target.value),className:"p-2 border border-gray-300 rounded-md w-full",placeholder:"Descripci\xf3n de la ubicaci\xf3n (opcional)"}):e.descripcion||"Sin descripci\xf3n"}),(0,a.jsx)("td",{className:"py-3 px-6 text-center space-x-4",children:x===e.id?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>D(e.id),className:"text-green-600 hover:text-green-800 transition-colors duration-200",title:"Guardar cambios",children:(0,a.jsx)(s.dIn,{size:18})}),(0,a.jsx)("button",{onClick:()=>{b(null),g(""),y("")},className:"text-red-600 hover:text-red-800 transition-colors duration-200",title:"Cancelar edici\xf3n",children:(0,a.jsx)(s.QCr,{size:18})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>R(e),className:"text-blue-600 hover:text-blue-800 transition-colors duration-200",title:"Editar Ubicaci\xf3n",children:(0,a.jsx)(s.uO9,{size:18})}),(0,a.jsx)("button",{onClick:()=>T(e.id),className:"text-red-600 hover:text-red-800 transition-colors duration-200",title:"Eliminar Ubicaci\xf3n",children:(0,a.jsx)(s.qbC,{size:18})})]})})]},e.id)):(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:"3",className:"text-center py-4 text-gray-500",children:"No se encontraron ubicaciones"})})})]})})})]}),(0,a.jsxs)(c(),{isOpen:S,onRequestClose:()=>_(!1),contentLabel:"Crear Nueva Ubicaci\xf3n",className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-auto my-8 p-6 outline-none",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-800",children:"Crear Nueva Ubicaci\xf3n"}),(0,a.jsx)("button",{onClick:()=>_(!1),className:"text-gray-500 hover:text-gray-700",title:"Cerrar Modal",children:(0,a.jsx)(s.QCr,{size:20})})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("label",{className:"block text-gray-700 mb-2",children:["Nombre",(0,a.jsx)("span",{className:"text-red-500",children:"*"}),":"]}),(0,a.jsx)("input",{type:"text",value:A,onChange:e=>z(e.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nombre de la ubicaci\xf3n"})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-gray-700 mb-2",children:"Descripci\xf3n:"}),(0,a.jsx)("textarea",{value:O,onChange:e=>L(e.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Descripci\xf3n de la ubicaci\xf3n (opcional)"})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)("button",{onClick:q,className:"bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600 transition-colors duration-200",children:"Guardar"}),(0,a.jsx)("button",{onClick:()=>{_(!1),z(""),L("")},className:"bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600 transition-colors duration-200",children:"Cancelar"})]})]})]})};var C=r(23093);let w=x()(m());c().setAppElement("#__next");let E=e=>{let{isOpen:t,onRequestClose:r}=e,[l,i]=(0,o.useState)([]),[n,d]=(0,o.useState)([]),[m,u]=(0,o.useState)(""),[x,b]=(0,o.useState)(null),[p,g]=(0,o.useState)(""),[f,y]=(0,o.useState)(""),[j,N]=(0,o.useState)(!1),[v,E]=(0,o.useState)(null),[k,S]=(0,o.useState)([]),[_,A]=(0,o.useState)(!1),[z,O]=(0,o.useState)(""),[L,B]=(0,o.useState)("");(0,o.useEffect)(()=>{t&&(M(),R())},[t]);let M=async()=>{N(!0);try{let[e,t]=await Promise.all([(0,h._0)(),(0,h.f2)()]);i(e.results||e),d(t.results||t)}catch(e){console.error("Error cargando datos:",e),C.oR.error("No se pudieron cargar los motivos o art\xedculos.",{position:"top-center"})}finally{N(!1)}},R=()=>{u(""),b(null),g(""),y(""),E(null),S([]),O(""),B("")},D=e=>{b(e.id),g(e.nombre),y(e.descripcion||"")},T=async e=>{if(!p.trim()){C.oR.error("El nombre no puede estar vac\xedo.",{position:"top-center"});return}if(l.some(t=>t.nombre.toLowerCase()===p.trim().toLowerCase()&&t.id!==e)){C.oR.error("Ya existe un motivo con este nombre.",{position:"top-center"});return}try{let t={nombre:p.trim(),descripcion:f.trim()?f.trim():"Sin descripci\xf3n"};console.log("Actualizando Motivo con datos:",t);let r=await (0,h.Yn)(e,t);C.oR.success("Motivo actualizado exitosamente.",{position:"top-center"}),i(l.map(t=>t.id===e?r:t)),b(null),g(""),y("")}catch(e){if(console.error("Error al actualizar el motivo:",e),e.response){console.log("Detalles del error:",e.response.data);let t=e.response.data;Object.keys(t).forEach(e=>{Array.isArray(t[e])?t[e].forEach(t=>{C.oR.error("Error en ".concat(capitalize(e),": ").concat(t),{position:"top-center"})}):C.oR.error("Error en ".concat(capitalize(e),": ").concat(t[e]),{position:"top-center"})})}else C.oR.error("Error al actualizar el motivo.",{position:"top-center"})}},q=async e=>{try{let t=n.filter(t=>t.motivo===e);if(t.length>0){S(t),E(e);return}(await w.fire({title:"\xbfEst\xe1s seguro?",text:"\xbfDeseas eliminar este motivo?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"S\xed, eliminar",cancelButtonText:"Cancelar"})).isConfirmed&&(await (0,h.y9)(e),C.oR.success("Motivo eliminado exitosamente.",{position:"top-center"}),i(l.filter(t=>t.id!==e)))}catch(e){if(console.error("Error al eliminar el motivo:",e),e.response){console.log("Detalles del error:",e.response.data);let t=e.response.data;Object.keys(t).forEach(e=>{Array.isArray(t[e])?t[e].forEach(t=>{C.oR.error("Error en ".concat(capitalize(e),": ").concat(t),{position:"top-center"})}):C.oR.error("Error en ".concat(capitalize(e),": ").concat(t[e]),{position:"top-center"})})}else C.oR.error("Error al eliminar el motivo.",{position:"top-center"})}},I=async()=>{if(!v)return;let e=k.map(e=>"• Nombre: ".concat(e.nombre,", Stock: ").concat(e.stock_actual,", C\xf3digo Minvu: ").concat(e.codigo_minvu||"N/A",", C\xf3digo Interno: ").concat(e.codigo_interno||"N/A",", N\xba Serie: ").concat(e.numero_serie||"N/A")).join("<br/>");if((await w.fire({title:"\xbfEst\xe1s seguro?",html:"\n        <p>El motivo seleccionado est\xe1 asociado a ".concat(k.length,' art\xedculo(s):</p>\n        <div style="max-height: 200px; overflow-y: auto; text-align: left;">\n          ').concat(e,"\n        </div>\n        <p>\xbfDeseas eliminarlo? Los art\xedculos asociados tendr\xe1n su motivo establecido en 'Sin motivo'.</p>\n      "),icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"S\xed, eliminar",cancelButtonText:"Cancelar",customClass:{popup:"swal2-overflow"}})).isConfirmed)try{await (0,h.y9)(v);let e=k.map(e=>updateArticulo(e.id,{motivo:null}));await Promise.all(e),C.oR.success("Motivo eliminado exitosamente y art\xedculos actualizados.",{position:"top-center"}),i(l.filter(e=>e.id!==v))}catch(e){if(console.error("Error al eliminar motivo con art\xedculos asociados:",e),e.response){console.log("Detalles del error:",e.response.data);let t=e.response.data;Object.keys(t).forEach(e=>{Array.isArray(t[e])?t[e].forEach(t=>{C.oR.error("Error en ".concat(capitalize(e),": ").concat(t),{position:"top-center"})}):C.oR.error("Error en ".concat(capitalize(e),": ").concat(t[e]),{position:"top-center"})})}else C.oR.error("Error al eliminar el motivo.",{position:"top-center"})}finally{E(null),S([])}else E(null),S([])};(0,o.useEffect)(()=>{v&&k.length>0&&I()},[v]);let P=async()=>{if(!z.trim()){C.oR.error("El nombre del motivo no puede estar vac\xedo.",{position:"top-center"});return}if(l.some(e=>e.nombre.toLowerCase()===z.trim().toLowerCase())){C.oR.error("Ya existe un motivo con este nombre.",{position:"top-center"});return}let e={nombre:z.trim(),descripcion:L.trim()?L.trim():"Sin descripci\xf3n"};console.log("Creando Motivo con datos:",e);try{let t=await (0,h.B6)(e);C.oR.success("Motivo creado exitosamente.",{position:"top-center"}),i([...l,t]),A(!1),O(""),B("")}catch(e){if(console.error("Error al crear motivo:",e),e.response){console.log("Detalles del error:",e.response.data);let t=e.response.data;Object.keys(t).forEach(e=>{Array.isArray(t[e])?t[e].forEach(t=>{C.oR.error("Error en ".concat(capitalize(e),": ").concat(t),{position:"top-center"})}):C.oR.error("Error en ".concat(capitalize(e),": ").concat(t[e]),{position:"top-center"})})}else C.oR.error("Error al crear el motivo.",{position:"top-center"})}},Q=l.filter(e=>e.nombre.toLowerCase().includes(m.toLowerCase()));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(c(),{isOpen:t,onRequestClose:r,contentLabel:"Administrar Motivos",className:"bg-white rounded-lg shadow-xl w-full max-w-5xl mx-auto my-8 p-6 outline-none",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-800",children:"Administrar Motivos"}),(0,a.jsx)("button",{onClick:r,className:"text-gray-500 hover:text-gray-700",title:"Cerrar Modal",children:(0,a.jsx)(s.QCr,{size:24})})]}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsxs)("button",{onClick:()=>A(!0),className:"flex items-center bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition-colors duration-200",title:"Crear Nuevo Motivo",children:[(0,a.jsx)(s.OiG,{className:"mr-2"})," Crear Motivo"]})}),(0,a.jsxs)("div",{className:"mb-4 flex items-center",children:[(0,a.jsx)("input",{type:"text",placeholder:"Buscar Motivo...",value:m,onChange:e=>u(e.target.value),className:"p-3 border border-gray-300 rounded-md w-full shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,a.jsx)(s.KSO,{className:"ml-2 text-gray-500"})]}),j?(0,a.jsx)("p",{className:"text-center text-lg text-gray-600",children:"Cargando motivos..."}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsx)("div",{className:"overflow-y-auto max-h-96",children:(0,a.jsxs)("table",{className:"min-w-full bg-white",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"bg-blue-100 sticky top-0",children:[" ",(0,a.jsx)("th",{className:"py-3 px-6 text-left text-sm font-medium text-gray-700",children:"Nombre"}),(0,a.jsx)("th",{className:"py-3 px-6 text-left text-sm font-medium text-gray-700",children:"Descripci\xf3n"}),(0,a.jsx)("th",{className:"py-3 px-6 text-center text-sm font-medium text-gray-700",children:"Acciones"})]})}),(0,a.jsx)("tbody",{children:Q.length>0?Q.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"py-3 px-6 text-sm text-gray-700",children:x===e.id?(0,a.jsx)("input",{type:"text",value:p,onChange:e=>g(e.target.value),className:"p-2 border border-gray-300 rounded-md w-full",placeholder:"Nombre del motivo"}):e.nombre}),(0,a.jsx)("td",{className:"py-3 px-6 text-sm text-gray-700",children:x===e.id?(0,a.jsx)("textarea",{value:f,onChange:e=>y(e.target.value),className:"p-2 border border-gray-300 rounded-md w-full",placeholder:"Descripci\xf3n del motivo (opcional)"}):e.descripcion||"Sin descripci\xf3n"}),(0,a.jsx)("td",{className:"py-3 px-6 text-center space-x-4",children:x===e.id?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>T(e.id),className:"text-green-600 hover:text-green-800 transition-colors duration-200",title:"Guardar cambios",children:(0,a.jsx)(s.dIn,{size:18})}),(0,a.jsx)("button",{onClick:()=>{b(null),g(""),y("")},className:"text-red-600 hover:text-red-800 transition-colors duration-200",title:"Cancelar edici\xf3n",children:(0,a.jsx)(s.QCr,{size:18})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>D(e),className:"text-blue-600 hover:text-blue-800 transition-colors duration-200",title:"Editar Motivo",children:(0,a.jsx)(s.uO9,{size:18})}),(0,a.jsx)("button",{onClick:()=>q(e.id),className:"text-red-600 hover:text-red-800 transition-colors duration-200",title:"Eliminar Motivo",children:(0,a.jsx)(s.qbC,{size:18})})]})})]},e.id)):(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:"3",className:"text-center py-4 text-gray-500",children:"No se encontraron motivos"})})})]})})})]}),(0,a.jsxs)(c(),{isOpen:_,onRequestClose:()=>A(!1),contentLabel:"Crear Nuevo Motivo",className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-auto my-8 p-6 outline-none",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-800",children:"Crear Nuevo Motivo"}),(0,a.jsx)("button",{onClick:()=>A(!1),className:"text-gray-500 hover:text-gray-700",title:"Cerrar Modal",children:(0,a.jsx)(s.QCr,{size:20})})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("label",{className:"block text-gray-700 mb-2",children:["Nombre",(0,a.jsx)("span",{className:"text-red-500",children:"*"}),":"]}),(0,a.jsx)("input",{type:"text",value:z,onChange:e=>O(e.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nombre del motivo"})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-gray-700 mb-2",children:"Descripci\xf3n:"}),(0,a.jsx)("textarea",{value:L,onChange:e=>B(e.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Descripci\xf3n del motivo (opcional)"})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)("button",{onClick:P,className:"bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600 transition-colors duration-200",children:"Guardar"}),(0,a.jsx)("button",{onClick:()=>{A(!1),O(""),B("")},className:"bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600 transition-colors duration-200",children:"Cancelar"})]})]})]})},k=x()(m());c().setAppElement("#__next");let S=e=>e.charAt(0).toUpperCase()+e.slice(1),_=e=>{let{isOpen:t,onRequestClose:r}=e,[l,i]=(0,o.useState)([]),[n,d]=(0,o.useState)([]),[m,u]=(0,o.useState)(""),[x,b]=(0,o.useState)(null),[p,g]=(0,o.useState)(""),[f,y]=(0,o.useState)(""),[j,N]=(0,o.useState)(!1),[v,C]=(0,o.useState)(null),[w,E]=(0,o.useState)([]),[_,A]=(0,o.useState)(!1),[z,O]=(0,o.useState)(""),[L,B]=(0,o.useState)("");(0,o.useEffect)(()=>{t&&(M(),R())},[t]);let M=async()=>{N(!0);try{let e=await (0,h.GP)();i(e.results||e);let t=await (0,h.f2)();d(t.results||t)}catch(e){console.error("Error cargando datos:",e),k.fire({icon:"error",title:"Error",text:"No se pudieron cargar los estados o art\xedculos."})}finally{N(!1)}},R=()=>{u(""),b(null),g(""),y(""),C(null),E([]),O(""),B("")},D=e=>{b(e.id),g(e.nombre),y(e.descripcion||"")},T=async e=>{if(!p.trim()){k.fire({icon:"error",title:"Error",text:"El nombre no puede estar vac\xedo."});return}if(l.some(t=>t.nombre.toLowerCase()===p.trim().toLowerCase()&&t.id!==e)){k.fire({icon:"error",title:"Error",text:"Ya existe un estado con este nombre."});return}try{let t=await (0,h.az)(e,p.trim()||"",f.trim()||"Sin descripci\xf3n");k.fire({icon:"success",title:"\xc9xito",text:"Estado actualizado correctamente."}),i(l.map(r=>r.id===e?t:r)),b(null),g(""),y("")}catch(e){if(console.error("Error al actualizar el estado:",e),e.response&&e.response.data){let t=e.response.data,r=Object.keys(t).map(e=>Array.isArray(t[e])?t[e].map(t=>"".concat(S(e),": ").concat(t)).join("<br/>"):"".concat(S(e),": ").concat(t[e])).join("<br/>");k.fire({icon:"error",title:"Error",html:r})}else k.fire({icon:"error",title:"Error",text:"Ocurri\xf3 un error al actualizar el estado."})}},q=async e=>{let t=n.filter(t=>t.estado===e);if(t.length>0){E(t),C(e);return}if((await k.fire({title:"\xbfEst\xe1s seguro?",text:"\xbfDeseas eliminar este estado?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"S\xed, eliminar",cancelButtonText:"Cancelar"})).isConfirmed)try{await (0,h.sv)(e)&&(k.fire({icon:"success",title:"Eliminado",text:"El estado ha sido eliminado correctamente."}),i(l.filter(t=>t.id!==e)))}catch(e){console.error("Error al eliminar estado:",e),k.fire({icon:"error",title:"Error",text:"Ocurri\xf3 un error al eliminar el estado."})}},I=(0,o.useCallback)(async()=>{if(!v)return;let e=w.map(e=>"• Nombre: ".concat(e.nombre,", Stock: ").concat(e.stock_actual,", C\xf3digo Minvu: ").concat(e.codigo_minvu||"N/A",", C\xf3digo Interno: ").concat(e.codigo_interno||"N/A",", N\xba Serie: ").concat(e.numero_serie||"N/A")).join("<br/>");if((await k.fire({title:"\xbfEst\xe1s seguro?",html:"\n        <p>El estado seleccionado est\xe1 asociado a ".concat(w.length,' art\xedculo(s):</p>\n        <div style="max-height: 200px; overflow-y: auto; text-align: left;">\n          ').concat(e,"\n        </div>\n        <p>\xbfDeseas eliminarlo? Los art\xedculos asociados tendr\xe1n su estado establecido en 'Sin estado'.</p>\n      "),icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"S\xed, eliminar",cancelButtonText:"Cancelar",customClass:{popup:"swal2-overflow"}})).isConfirmed)try{await (0,h.sv)(v)&&(k.fire({icon:"success",title:"Eliminado",text:"El estado y las asociaciones han sido eliminadas correctamente."}),i(l.filter(e=>e.id!==v)))}catch(e){console.error("Error al eliminar estado con art\xedculos asociados:",e),k.fire({icon:"error",title:"Error",text:"Ocurri\xf3 un error al eliminar el estado y actualizar los art\xedculos asociados."})}finally{C(null),E([])}else C(null),E([])},[v,w,l]);(0,o.useEffect)(()=>{v&&w.length>0&&I()},[v,w.length,I]);let P=async()=>{if(!z.trim()){k.fire({icon:"error",title:"Error",text:"El nombre del estado no puede estar vac\xedo."});return}if(l.some(e=>e.nombre.toLowerCase()===z.trim().toLowerCase())){k.fire({icon:"error",title:"Error",text:"Ya existe un estado con este nombre."});return}try{let e=await (0,h.HA)(z.trim()||"",L.trim()||"Sin descripci\xf3n");k.fire({icon:"success",title:"\xc9xito",text:"Estado creado correctamente."}),i([...l,e]),A(!1),O(""),B("")}catch(e){if(console.error("Error al crear estado:",e),e.response&&e.response.data){let t=e.response.data,r=Object.keys(t).map(e=>Array.isArray(t[e])?t[e].map(t=>"".concat(S(e),": ").concat(t)).join("<br/>"):"".concat(S(e),": ").concat(t[e])).join("<br/>");k.fire({icon:"error",title:"Error",html:r})}else k.fire({icon:"error",title:"Error",text:"Ocurri\xf3 un error al crear el estado."})}},Q=l.filter(e=>e.nombre.toLowerCase().includes(m.toLowerCase()));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(c(),{isOpen:t,onRequestClose:r,contentLabel:"Administrar Estados",className:"bg-white rounded-lg shadow-xl w-full max-w-5xl mx-auto my-8 p-6 outline-none",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-800",children:"Administrar Estados"}),(0,a.jsx)("button",{onClick:r,className:"text-gray-500 hover:text-gray-700",title:"Cerrar Modal",children:(0,a.jsx)(s.QCr,{size:24})})]}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsxs)("button",{onClick:()=>A(!0),className:"flex items-center bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600",title:"Crear Nuevo Estado",children:[(0,a.jsx)(s.OiG,{className:"mr-2"})," Crear Estado"]})}),(0,a.jsxs)("div",{className:"mb-4 flex items-center",children:[(0,a.jsx)("input",{type:"text",placeholder:"Buscar Estado...",value:m,onChange:e=>u(e.target.value),className:"p-3 border border-gray-300 rounded-md w-full focus:ring-2 focus:ring-blue-500"}),(0,a.jsx)(s.KSO,{className:"ml-2 text-gray-500"})]}),j?(0,a.jsx)("p",{className:"text-center text-lg text-gray-600",children:"Cargando estados..."}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsx)("div",{className:"overflow-y-auto max-h-96",children:(0,a.jsxs)("table",{className:"min-w-full bg-white",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"bg-blue-100 sticky top-0",children:[(0,a.jsx)("th",{className:"py-3 px-6 text-left text-sm font-medium text-gray-700",children:"Nombre"}),(0,a.jsx)("th",{className:"py-3 px-6 text-left text-sm font-medium text-gray-700",children:"Descripci\xf3n"}),(0,a.jsx)("th",{className:"py-3 px-6 text-center text-sm font-medium text-gray-700",children:"Acciones"})]})}),(0,a.jsx)("tbody",{children:Q.length>0?Q.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"py-3 px-6 text-sm text-gray-700",children:x===e.id?(0,a.jsx)("input",{type:"text",value:p,onChange:e=>g(e.target.value),className:"p-2 border border-gray-300 rounded-md w-full",placeholder:"Nombre del estado"}):e.nombre}),(0,a.jsx)("td",{className:"py-3 px-6 text-sm text-gray-700",children:x===e.id?(0,a.jsx)("textarea",{value:f,onChange:e=>y(e.target.value),className:"p-2 border border-gray-300 rounded-md w-full",placeholder:"Descripci\xf3n del estado (opcional)"}):e.descripcion||"Sin descripci\xf3n"}),(0,a.jsx)("td",{className:"py-3 px-6 text-center space-x-4",children:x===e.id?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>T(e.id),className:"text-green-600 hover:text-green-800",title:"Guardar cambios",children:(0,a.jsx)(s.dIn,{size:18})}),(0,a.jsx)("button",{onClick:()=>{b(null),g(""),y("")},className:"text-red-600 hover:text-red-800",title:"Cancelar edici\xf3n",children:(0,a.jsx)(s.QCr,{size:18})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>D(e),className:"text-blue-600 hover:text-blue-800",title:"Editar Estado",children:(0,a.jsx)(s.uO9,{size:18})}),(0,a.jsx)("button",{onClick:()=>q(e.id),className:"text-red-600 hover:text-red-800",title:"Eliminar Estado",children:(0,a.jsx)(s.qbC,{size:18})})]})})]},e.id)):(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:"3",className:"text-center py-4 text-gray-500",children:"No se encontraron estados"})})})]})})})]}),(0,a.jsxs)(c(),{isOpen:_,onRequestClose:()=>A(!1),contentLabel:"Crear Nuevo Estado",className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-auto my-8 p-6 outline-none",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-800",children:"Crear Nuevo Estado"}),(0,a.jsx)("button",{onClick:()=>A(!1),className:"text-gray-500 hover:text-gray-700",title:"Cerrar Modal",children:(0,a.jsx)(s.QCr,{size:20})})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("label",{className:"block text-gray-700 mb-2",children:["Nombre",(0,a.jsx)("span",{className:"text-red-500",children:"*"}),":"]}),(0,a.jsx)("input",{type:"text",value:z,onChange:e=>O(e.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500",placeholder:"Nombre del estado"})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-gray-700 mb-2",children:"Descripci\xf3n:"}),(0,a.jsx)("textarea",{value:L,onChange:e=>B(e.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500",placeholder:"Descripci\xf3n del estado (opcional)"})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)("button",{onClick:P,className:"bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600",children:"Guardar"}),(0,a.jsx)("button",{onClick:()=>{A(!1),O(""),B("")},className:"bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600",children:"Cancelar"})]})]})]})};c().setAppElement("#__next");let A=x()(m()),z=e=>{let{isOpen:t,onRequestClose:r}=e,[l,i]=(0,o.useState)([]),[n,d]=(0,o.useState)([]),[m,u]=(0,o.useState)(null),[x,b]=(0,o.useState)(""),[p,g]=(0,o.useState)(!1),[f,y]=(0,o.useState)(""),j=async()=>{g(!0);try{let e=await (0,h.f2)();i(e),d(e)}catch(e){console.error("Fetch Articulos Error:",e),A.fire({icon:"error",title:"Error",text:"No se pudieron cargar los art\xedculos."})}finally{g(!1)}};(0,o.useEffect)(()=>{t&&(j(),u(null),b(""),y(""))},[t]);let N=e=>{u(e.id),b(null!==e.stock_minimo&&void 0!==e.stock_minimo?String(e.stock_minimo):"")},v=async e=>{if(""===x){A.fire({icon:"error",title:"Error",text:"El stock m\xednimo no puede estar vac\xedo."});return}let t=Number(x);if(isNaN(t)||t<0){A.fire({icon:"error",title:"Error",text:"El stock m\xednimo debe ser un n\xfamero v\xe1lido y no negativo."});return}try{await (0,h.eM)(e,t);let r=l.map(r=>r.id===e?{...r,stock_minimo:t}:r);i(r),d(r.filter(e=>e.nombre.toLowerCase().includes(f.toLowerCase()))),u(null),b(""),A.fire({icon:"success",title:"\xc9xito",text:"Stock m\xednimo actualizado correctamente."})}catch(e){console.error("Handle Save Error:",e),e.response?A.fire({icon:"error",title:"Error",text:e.response.data.error||"No se pudo actualizar el stock m\xednimo."}):e.request?A.fire({icon:"error",title:"Error",text:"No se recibi\xf3 respuesta del servidor."}):A.fire({icon:"error",title:"Error",text:"Ocurri\xf3 un error al intentar actualizar el stock m\xednimo."})}};return(0,a.jsxs)(c(),{isOpen:t,onRequestClose:r,contentLabel:"Actualizar Stock M\xednimo",className:"bg-white rounded-xl shadow-xl w-full max-w-5xl mx-auto my-8 p-6 outline-none",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-800",children:"Actualizar Stock M\xednimo"}),(0,a.jsx)("button",{onClick:r,className:"text-gray-500 hover:text-gray-700",children:(0,a.jsx)(s.QCr,{size:24})})]}),(0,a.jsxs)("div",{className:"mb-4 flex items-center",children:[(0,a.jsx)("input",{type:"text",placeholder:"Buscar art\xedculo...",value:f,onChange:e=>{let t=e.target.value;y(t),d(l.filter(e=>e.nombre.toLowerCase().includes(t.toLowerCase())))},className:"p-3 border border-gray-300 rounded-md w-full shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,a.jsx)(s.KSO,{className:"ml-2 text-gray-500"})]}),p?(0,a.jsx)("p",{className:"text-center text-lg text-gray-600",children:"Cargando art\xedculos..."}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsx)("div",{className:"overflow-y-auto max-h-96",children:(0,a.jsxs)("table",{className:"min-w-full bg-white",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"bg-blue-100 sticky top-0",children:[(0,a.jsx)("th",{className:"py-3 px-6 text-left text-sm font-medium text-gray-700",children:"Nombre"}),(0,a.jsx)("th",{className:"py-3 px-6 text-left text-sm font-medium text-gray-700",children:"Stock Actual"}),(0,a.jsx)("th",{className:"py-3 px-6 text-left text-sm font-medium text-gray-700",children:"Stock M\xednimo"}),(0,a.jsx)("th",{className:"py-3 px-6 text-center text-sm font-medium text-gray-700",children:"Acciones"})]})}),(0,a.jsxs)("tbody",{children:[n.map(e=>{var t;return(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"py-3 px-6 text-sm text-gray-700",children:e.nombre}),(0,a.jsx)("td",{className:"py-3 px-6 text-sm text-gray-700",children:e.stock_actual}),(0,a.jsx)("td",{className:"py-3 px-6 text-sm text-gray-700",children:m===e.id?(0,a.jsx)("input",{type:"number",value:x,onChange:e=>b(e.target.value),className:"p-2 border border-gray-300 rounded-md w-full"}):null!==(t=e.stock_minimo)&&void 0!==t?t:0}),(0,a.jsx)("td",{className:"py-3 px-6 text-center space-x-2",children:m===e.id?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>v(e.id),className:"text-green-500 hover:text-green-700",title:"Guardar",children:(0,a.jsx)(s.dIn,{size:18})}),(0,a.jsx)("button",{onClick:()=>{u(null),b("")},className:"text-red-500 hover:text-red-700",title:"Cancelar",children:(0,a.jsx)(s.QCr,{size:18})})]}):(0,a.jsx)("button",{onClick:()=>N(e),className:"text-blue-500 hover:text-blue-700",title:"Editar Stock M\xednimo",children:(0,a.jsx)(s.uO9,{size:18})})})]},e.id)}),0===n.length&&(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:"4",className:"py-4 text-center text-gray-600",children:"No se encontraron art\xedculos."})})]})]})})})]})};var O=r(46005);c().setAppElement("#__next");let L=e=>{let{isOpen:t,onRequestClose:r}=e,[l,i]=(0,o.useState)([]),[n,d]=(0,o.useState)([]),[u,x]=(0,o.useState)([]),[b,p]=(0,o.useState)([]),[g,f]=(0,o.useState)([]),[y,j]=(0,o.useState)([]),[N,v]=(0,o.useState)(!1),[C,w]=(0,o.useState)(""),[E,k]=(0,o.useState)(!1),[S,_]=(0,o.useState)(null),[A,z]=(0,o.useState)({nombre:"",categoria:"",marca:"",modelo:"",descripcion:"",codigo_interno:"",codigo_minvu:"",numero_serie:"",mac:"",ubicacion:"",estado:"",stock_actual:""}),[L,B]=(0,o.useState)({codigo_minvu:!1,codigo_interno:!1,numero_serie:!1,mac:!1});(0,o.useEffect)(()=>{t&&(async()=>{v(!0);try{let[e,t,r,a,o,s]=await Promise.all([(0,h.f2)(),(0,h.vo)(),(0,h.C7)(),(0,h.yX)(),(0,h.jI)(),(0,h.GP)()]);i(e.results||e),d(t.map(e=>({value:e.id,label:e.nombre}))),x(r.map(e=>({value:e.id,label:e.nombre}))),p(a.map(e=>({value:e.id,label:e.nombre}))),f(o.map(e=>({value:e.id,label:e.nombre}))),j(s.map(e=>({value:e.id,label:e.nombre})))}catch(e){m().fire("Error","Error al cargar datos.","error")}finally{v(!1)}})()},[t]);let M=e=>{let{name:t,value:r}=e.target;z(e=>({...e,[t]:r}))},R=(e,t)=>{let{name:r}=t;if("categoria"===r){let t=n.find(t=>t.value===(null==e?void 0:e.value));(null==t?void 0:t.label)!=="PC"&&A.mac?m().fire({title:"Advertencia",text:"El cambio de categor\xeda eliminar\xe1 el valor de MAC Address.",icon:"warning",showCancelButton:!0,confirmButtonText:"Continuar",cancelButtonText:"Cancelar"}).then(t=>{t.isConfirmed?z(t=>({...t,mac:"",categoria:e?e.value:""})):z(e=>({...e,categoria:S?S.categoria:""}))}):z(t=>({...t,categoria:e?e.value:""}))}else z(t=>({...t,[r]:e?e.value:""}))},D=e=>{_(e),z({nombre:e.nombre,categoria:e.categoria,marca:e.marca,modelo:e.modelo,descripcion:e.descripcion,codigo_interno:e.codigo_interno,codigo_minvu:e.codigo_minvu,numero_serie:e.numero_serie,mac:e.mac,ubicacion:e.ubicacion,estado:e.estado,stock_actual:e.stock_actual}),B({codigo_minvu:!1,codigo_interno:!1,numero_serie:!1,mac:!1}),k(!0)},T=async()=>{if(!A.nombre.trim()){m().fire("Error","El nombre del art\xedculo no puede estar vac\xedo.","error");return}if(!A.categoria){m().fire("Error","Seleccione una categor\xeda.","error");return}if(!A.marca){m().fire("Error","Seleccione una marca.","error");return}if(!A.modelo){m().fire("Error","Seleccione un modelo.","error");return}if(!A.ubicacion){m().fire("Error","Seleccione una ubicaci\xf3n.","error");return}if(!A.estado){m().fire("Error","Seleccione un estado.","error");return}let e=[],t={codigo_minvu:!1,codigo_interno:!1,numero_serie:!1,mac:!1};if(["codigo_minvu","codigo_interno","numero_serie","mac"].forEach(r=>{let a=A[r].trim().toLowerCase();a&&l.some(e=>{var t;return(null===(t=e[r])||void 0===t?void 0:t.toLowerCase())===a&&e.id!==S.id})&&(e.push(r.replace("_"," ")),t[r]=!0)}),e.length>0){B(t),m().fire("Errores de Duplicaci\xf3n","Los siguientes campos ya existen: ".concat(e.join(", "),"."),"error");return}B({codigo_minvu:!1,codigo_interno:!1,numero_serie:!1,mac:!1});let r=n.find(e=>e.value===A.categoria);(null==r?void 0:r.label)!=="PC"&&A.mac&&(m().fire("Advertencia","La categor\xeda seleccionada no requiere MAC Address. El campo se eliminar\xe1.","warning"),z(e=>({...e,mac:""})));try{await updateArticulo(S.id,A),m().fire("\xc9xito","Cambios guardados correctamente.","success"),k(!1),i(e=>e.map(e=>e.id===S.id?{...e,...A}:e))}catch(e){console.error("Error al guardar los cambios:",e)}},q=()=>{k(!1),_(null),z({nombre:"",categoria:"",marca:"",modelo:"",descripcion:"",codigo_interno:"",codigo_minvu:"",numero_serie:"",mac:"",ubicacion:"",estado:"",stock_actual:""}),B({codigo_minvu:!1,codigo_interno:!1,numero_serie:!1,mac:!1})},I=n.find(e=>e.value===A.categoria),P=(0,o.useCallback)((e,t)=>t?e.filter(e=>{var r,a,o;let s=t.toLowerCase();return e.nombre&&e.nombre.toLowerCase().includes(s)||(null===(r=n.find(t=>t.value===e.categoria))||void 0===r?void 0:r.label.toLowerCase().includes(s))||(null===(a=u.find(t=>t.value===e.marca))||void 0===a?void 0:a.label.toLowerCase().includes(s))||(null===(o=b.find(t=>t.value===e.modelo))||void 0===o?void 0:o.label.toLowerCase().includes(s))||e.numero_serie&&e.numero_serie.toLowerCase().includes(s)||e.codigo_minvu&&e.codigo_minvu.toLowerCase().includes(s)||e.codigo_interno&&e.codigo_interno.toLowerCase().includes(s)||e.mac&&e.mac.toLowerCase().includes(s)}):e,[n,u,b]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(c(),{isOpen:t,onRequestClose:r,contentLabel:"Lista de Art\xedculos",className:"bg-white rounded-lg shadow-xl w-full max-w-5xl mx-auto p-6 overflow-auto",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-800",children:"Lista de Art\xedculos"}),(0,a.jsx)("button",{onClick:r,className:"text-gray-600 hover:text-gray-800",children:(0,a.jsx)(s.QCr,{size:24})})]}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)("input",{type:"text",placeholder:"Buscar art\xedculo...",value:C,onChange:e=>w(e.target.value),className:"w-full p-3 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})}),(0,a.jsx)("div",{className:"overflow-y-auto max-h-96",children:(0,a.jsxs)("table",{className:"min-w-full bg-white",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"bg-blue-100 sticky top-0",children:[(0,a.jsx)("th",{className:"py-3 px-6 text-left text-sm font-medium text-gray-700",children:"Nombre"}),(0,a.jsx)("th",{className:"py-3 px-6 text-left text-sm font-medium text-gray-700",children:"Categor\xeda"}),(0,a.jsx)("th",{className:"py-3 px-6 text-left text-sm font-medium text-gray-700",children:"Marca"}),(0,a.jsx)("th",{className:"py-3 px-6 text-left text-sm font-medium text-gray-700",children:"Modelo"}),(0,a.jsx)("th",{className:"py-3 px-6 text-left text-sm font-medium text-gray-700",children:"N\xfamero de Serie"}),(0,a.jsx)("th",{className:"py-3 px-6 text-left text-sm font-medium text-gray-700",children:"C\xf3digo MINVU"}),(0,a.jsx)("th",{className:"py-3 px-6 text-left text-sm font-medium text-gray-700",children:"C\xf3digo Interno"}),(0,a.jsx)("th",{className:"py-3 px-6 text-left text-sm font-medium text-gray-700",children:"MAC"}),(0,a.jsx)("th",{className:"py-3 px-6 text-center text-sm font-medium text-gray-700",children:"Acciones"})]})}),(0,a.jsx)("tbody",{children:N?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:"9",className:"py-4 text-center text-gray-600",children:"Cargando art\xedculos..."})}):0===l.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:"9",className:"py-4 text-center text-gray-600",children:"No se encontraron art\xedculos."})}):P(l,C).map(e=>{var t,r,o;return(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"py-3 px-6 text-sm text-gray-700",children:e.nombre}),(0,a.jsx)("td",{className:"py-3 px-6 text-sm text-gray-700",children:(null===(t=n.find(t=>t.value===e.categoria))||void 0===t?void 0:t.label)||"N/A"}),(0,a.jsx)("td",{className:"py-3 px-6 text-sm text-gray-700",children:(null===(r=u.find(t=>t.value===e.marca))||void 0===r?void 0:r.label)||"N/A"}),(0,a.jsx)("td",{className:"py-3 px-6 text-sm text-gray-700",children:(null===(o=b.find(t=>t.value===e.modelo))||void 0===o?void 0:o.label)||"N/A"}),(0,a.jsx)("td",{className:"py-3 px-6 text-sm text-gray-700",children:e.numero_serie||"N/A"}),(0,a.jsx)("td",{className:"py-3 px-6 text-sm text-gray-700",children:e.codigo_minvu||"N/A"}),(0,a.jsx)("td",{className:"py-3 px-6 text-sm text-gray-700",children:e.codigo_interno||"N/A"}),(0,a.jsx)("td",{className:"py-3 px-6 text-sm text-gray-700",children:e.mac||"N/A"}),(0,a.jsx)("td",{className:"py-3 px-6 text-center",children:(0,a.jsx)("button",{onClick:()=>D(e),className:"text-blue-500 hover:text-blue-700",title:"Editar Art\xedculo",children:(0,a.jsx)(s.uO9,{size:18})})})]},e.id)})})]})})]}),E&&S&&(0,a.jsxs)(c(),{isOpen:E,onRequestClose:q,contentLabel:"Editar Art\xedculo",className:"bg-white rounded-lg shadow-xl w-full max-w-4xl mx-auto p-6 overflow-auto",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-800",children:"Editar Art\xedculo"}),(0,a.jsx)("button",{onClick:q,className:"text-gray-600 hover:text-gray-800",children:(0,a.jsx)(s.QCr,{size:24})})]}),(0,a.jsxs)("form",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:space-x-6",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Nombre"}),(0,a.jsx)("input",{type:"text",name:"nombre",value:A.nombre,onChange:M,className:"mt-1 block w-full p-3 border ".concat(L.nombre?"border-red-500":"border-gray-300"," rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"),placeholder:"Nombre del art\xedculo"})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Categor\xeda"}),(0,a.jsx)(O.Ay,{name:"categoria",value:n.find(e=>e.value===A.categoria),onChange:e=>R(e,{name:"categoria"}),options:n,placeholder:"Seleccione una categor\xeda",className:"mt-1"})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Stock Actual"}),(0,a.jsx)("input",{type:"text",name:"stock_actual",value:A.stock_actual,readOnly:!0,className:"mt-1 block w-full p-3 border border-gray-300 bg-gray-100 rounded-md cursor-not-allowed"})]})]}),(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:space-x-6",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Marca"}),(0,a.jsx)(O.Ay,{name:"marca",value:u.find(e=>e.value===A.marca),onChange:e=>R(e,{name:"marca"}),options:u,placeholder:"Seleccione una marca",className:"mt-1"})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Modelo"}),(0,a.jsx)(O.Ay,{name:"modelo",value:b.find(e=>e.value===A.modelo),onChange:e=>R(e,{name:"modelo"}),options:b,placeholder:"Seleccione un modelo",className:"mt-1"})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Ubicaci\xf3n"}),(0,a.jsx)(O.Ay,{name:"ubicacion",value:g.find(e=>e.value===A.ubicacion),onChange:e=>R(e,{name:"ubicacion"}),options:g,placeholder:"Seleccione una ubicaci\xf3n",className:"mt-1"})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Estado"}),(0,a.jsx)(O.Ay,{name:"estado",value:y.find(e=>e.value===A.estado),onChange:e=>R(e,{name:"estado"}),options:y,placeholder:"Seleccione un estado",className:"mt-1"})]})]}),(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:space-x-6",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"C\xf3digo MINVU"}),(0,a.jsx)("input",{type:"text",name:"codigo_minvu",value:A.codigo_minvu,onChange:M,className:"mt-1 block w-full p-3 border ".concat(L.codigo_minvu?"border-red-500":"border-gray-300"," rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"),placeholder:"C\xf3digo MINVU"})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"C\xf3digo Interno"}),(0,a.jsx)("input",{type:"text",name:"codigo_interno",value:A.codigo_interno,onChange:M,className:"mt-1 block w-full p-3 border ".concat(L.codigo_interno?"border-red-500":"border-gray-300"," rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"),placeholder:"C\xf3digo Interno"})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"N\xfamero de Serie"}),(0,a.jsx)("input",{type:"text",name:"numero_serie",value:A.numero_serie,onChange:M,className:"mt-1 block w-full p-3 border ".concat(L.numero_serie?"border-red-500":"border-gray-300"," rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"),placeholder:"N\xfamero de Serie"})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"MAC Address"}),(0,a.jsx)("input",{type:"text",name:"mac",value:A.mac,onChange:M,className:"mt-1 block w-full p-3 border ".concat(L.mac?"border-red-500":(null==I?void 0:I.label)!=="PC"?"border-gray-300 bg-gray-100 cursor-not-allowed":"border-gray-300"," rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"),placeholder:"MAC Address",disabled:(null==I?void 0:I.label)!=="PC"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Descripci\xf3n"}),(0,a.jsx)("textarea",{name:"descripcion",value:A.descripcion,onChange:M,className:"mt-1 block w-full p-3 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Descripci\xf3n del art\xedculo",rows:"3"})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,a.jsxs)("button",{type:"button",onClick:T,className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors duration-200",children:[(0,a.jsx)(s.dIn,{className:"mr-2"}),"Guardar"]}),(0,a.jsxs)("button",{type:"button",onClick:q,className:"flex items-center px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors duration-200",children:[(0,a.jsx)(s.QCr,{className:"mr-2"}),"Salir"]})]})]})]})]})};x()(m()),c().setAppElement("#__next");let B=e=>{let{isOpen:t,onRequestClose:r}=e,[l,i]=(0,o.useState)([]),[n,d]=(0,o.useState)(!1),[u,x]=(0,o.useState)(""),[b,p]=(0,o.useState)(null),[g,f]=(0,o.useState)(""),[y,j]=(0,o.useState)(""),[N,v]=(0,o.useState)(""),[C,w]=(0,o.useState)({correo_institucional:!1}),[E,k]=(0,o.useState)(!1),[S,_]=(0,o.useState)(""),[A,z]=(0,o.useState)({correo_institucional:!1});(0,o.useEffect)(()=>{t&&(O(),L(),B())},[t]);let O=async()=>{d(!0);try{let e=await (0,h.HK)();i(e.results||e)}catch(e){m().fire("Error","Error al cargar los datos de personal.","error")}finally{d(!1)}},L=()=>{p(null),f(""),j(""),v(""),w({correo_institucional:!1})},B=()=>{_(""),z({correo_institucional:!1})},M=e=>{p(e.id),f(e.nombre),j(e.correo_institucional),v(e.seccion),w({correo_institucional:!1})},R=async()=>{let e={correo_institucional:!y.trim()};if(Object.values(e).some(e=>e)){w(e),m().fire("Error","Por favor, complete el correo institucional.","error");return}if(l.some(e=>e.correo_institucional.toLowerCase()===y.trim().toLowerCase()&&e.id!==b)){m().fire("Error","El correo institucional ya est\xe1 registrado.","error"),w({...e,correo_institucional:!0});return}let t={nombre:g.trim()||"Sin nombre",correo_institucional:y.trim(),seccion:N.trim()||"Sin secci\xf3n"};try{let e=await (0,h.eu)(b,t);m().fire("\xc9xito","El personal se actualiz\xf3 correctamente.","success"),i(t=>t.map(t=>t.id===b?{...t,...e}:t)),L()}catch(e){m().fire("Error","Ocurri\xf3 un error al actualizar el personal.","error")}},D=async e=>{try{if(await T(e)){m().fire("Error","Este personal tiene pr\xe9stamos activos y no puede ser eliminado.","error");return}(await m().fire({title:"\xbfEst\xe1s seguro?",text:"Esta acci\xf3n eliminar\xe1 el registro de forma permanente.",icon:"warning",showCancelButton:!0,confirmButtonText:"S\xed, eliminar",cancelButtonText:"Cancelar"})).isConfirmed&&(await (0,h.aL)(e),m().fire("\xc9xito","El personal fue eliminado correctamente.","success"),i(t=>t.filter(t=>t.id!==e)))}catch(e){m().fire("Error","Ocurri\xf3 un error al eliminar el personal.","error")}},T=async e=>{try{let t=await fetch("/api/personal/".concat(e,"/prestamos_activos/"));if(t.ok)return(await t.json()).has_active_loans;return!1}catch(e){return console.error("Error al verificar pr\xe9stamos activos:",e),!1}},q=async()=>{let e={correo_institucional:!S.trim()};if(Object.values(e).some(e=>e)){z(e),m().fire("Error","Por favor, complete el correo institucional.","error");return}if(l.some(e=>e.correo_institucional.toLowerCase()===S.trim().toLowerCase())){m().fire("Error","El correo institucional ya est\xe1 registrado.","error"),z({...e,correo_institucional:!0});return}let t={nombre:"Sin nombre",correo_institucional:S.trim(),seccion:"Sin secci\xf3n"};try{let e=await (0,h.fN)(t);m().fire("\xc9xito","Nuevo personal agregado correctamente.","success"),i(t=>[...t,e]),k(!1),B()}catch(e){m().fire("Error","Ocurri\xf3 un error al crear el personal.","error")}},I=()=>{k(!1),B()},P=(0,o.useCallback)((e,t)=>{if(!t)return e;let r=t.toLowerCase();return e.filter(e=>e.nombre.toLowerCase().includes(r)||e.correo_institucional.toLowerCase().includes(r)||e.seccion.toLowerCase().includes(r))},[]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(c(),{isOpen:t,onRequestClose:r,contentLabel:"Administrar Personal",className:"bg-white rounded-lg shadow-xl w-full max-w-5xl mx-auto p-6 overflow-auto",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-800",children:"Administrar Personal"}),(0,a.jsx)("button",{onClick:r,className:"text-gray-500 hover:text-gray-700",title:"Cerrar Modal",children:(0,a.jsx)(s.QCr,{size:24})})]}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsxs)("button",{onClick:()=>{k(!0),B()},className:"flex items-center bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition-colors duration-200",title:"Crear Nuevo Personal",children:[(0,a.jsx)(s.OiG,{className:"mr-2"})," Crear Personal"]})}),(0,a.jsxs)("div",{className:"mb-4 flex items-center",children:[(0,a.jsx)("input",{type:"text",placeholder:"Buscar personal...",value:u,onChange:e=>x(e.target.value),className:"p-3 border border-gray-300 rounded-md w-full shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,a.jsx)(s.dIn,{className:"ml-2 text-gray-500"})]}),n?(0,a.jsx)("p",{className:"text-center text-lg text-gray-600",children:"Cargando datos..."}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsx)("div",{className:"overflow-y-auto max-h-96",children:(0,a.jsxs)("table",{className:"min-w-full bg-white",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"bg-blue-100 sticky top-0",children:[(0,a.jsx)("th",{className:"py-3 px-6 text-left text-sm font-medium text-gray-700",children:"Nombre"}),(0,a.jsx)("th",{className:"py-3 px-6 text-left text-sm font-medium text-gray-700",children:"Correo Institucional"}),(0,a.jsx)("th",{className:"py-3 px-6 text-left text-sm font-medium text-gray-700",children:"Secci\xf3n"}),(0,a.jsx)("th",{className:"py-3 px-6 text-center text-sm font-medium text-gray-700",children:"Acciones"})]})}),(0,a.jsx)("tbody",{children:P(l,u).length>0?P(l,u).map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"py-3 px-6 text-sm text-gray-700",children:b===e.id?(0,a.jsx)("input",{type:"text",value:g,onChange:e=>f(e.target.value),className:"p-2 border border-gray-300 rounded-md w-full",placeholder:"Nombre del personal"}):e.nombre}),(0,a.jsx)("td",{className:"py-3 px-6 text-sm text-gray-700",children:b===e.id?(0,a.jsx)("input",{type:"email",value:y,onChange:e=>j(e.target.value),className:"p-2 border border-gray-300 rounded-md w-full",placeholder:"Correo institucional"}):e.correo_institucional}),(0,a.jsx)("td",{className:"py-3 px-6 text-sm text-gray-700",children:b===e.id?(0,a.jsx)("input",{type:"text",value:N,onChange:e=>v(e.target.value),className:"p-2 border border-gray-300 rounded-md w-full",placeholder:"Secci\xf3n"}):e.seccion}),(0,a.jsx)("td",{className:"py-3 px-6 text-center space-x-4",children:b===e.id?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:R,className:"text-green-600 hover:text-green-800 transition-colors duration-200",title:"Guardar cambios",children:(0,a.jsx)(s.dIn,{size:18})}),(0,a.jsx)("button",{onClick:L,className:"text-red-600 hover:text-red-800 transition-colors duration-200",title:"Cancelar edici\xf3n",children:(0,a.jsx)(s.QCr,{size:18})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>M(e),className:"text-blue-600 hover:text-blue-800 transition-colors duration-200",title:"Editar Personal",children:(0,a.jsx)(s.uO9,{size:18})}),(0,a.jsx)("button",{onClick:()=>D(e.id),className:"text-red-600 hover:text-red-800 transition-colors duration-200",title:"Eliminar Personal",children:(0,a.jsx)(s.qbC,{size:18})})]})})]},e.id)):(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:"4",className:"text-center py-4 text-gray-500",children:"No se encontraron registros."})})})]})})})]}),(0,a.jsxs)(c(),{isOpen:E,onRequestClose:I,contentLabel:"Crear Nuevo Personal",className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-auto p-6 overflow-auto",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-800",children:"Crear Nuevo Personal"}),(0,a.jsx)("button",{onClick:I,className:"text-gray-500 hover:text-gray-700",title:"Cerrar Modal",children:(0,a.jsx)(s.QCr,{size:20})})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("label",{className:"block text-gray-700 mb-2",children:["Correo Institucional",(0,a.jsx)("span",{className:"text-red-500",children:"*"}),":"]}),(0,a.jsx)("input",{type:"email",value:S,onChange:e=>_(e.target.value),className:"w-full p-2 border ".concat(A.correo_institucional?"border-red-500":"border-gray-300"," rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"),placeholder:"Correo institucional"})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,a.jsxs)("button",{onClick:q,className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors duration-200",children:[(0,a.jsx)(s.dIn,{className:"mr-2"}),"Guardar"]}),(0,a.jsxs)("button",{onClick:I,className:"flex items-center px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors duration-200",children:[(0,a.jsx)(s.QCr,{className:"mr-2"}),"Cancelar"]})]})]})]})};r(74338);let M=()=>{let[e,t]=(0,o.useState)(!1),[r,n]=(0,o.useState)(!1),[c,d]=(0,o.useState)(!1),[m,u]=(0,o.useState)(!1),[x,h]=(0,o.useState)(!1),[b,g]=(0,o.useState)(!1),[y,N]=(0,o.useState)(!1),[w,k]=(0,o.useState)(!1),[S,A]=(0,o.useState)(!1);return(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(l.A,{}),(0,a.jsxs)("main",{className:"flex-1 p-6 bg-gray-100 sm:ml-64",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Administraci\xf3n General"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:[(0,a.jsx)(i,{title:"Categor\xedas",description:"Agregar, editar o desactivar categor\xedas de productos.",icon:s.BuZ,color:"text-yellow-500",onClick:()=>t(!0)}),(0,a.jsx)(i,{title:"Marcas",description:"Gestionar marcas asociadas a los productos.",icon:s.rrY,color:"text-blue-500",onClick:()=>n(!0)}),(0,a.jsx)(i,{title:"Modelos",description:"Administrar los modelos disponibles de cada marca.",icon:s.C8d,color:"text-green-500",onClick:()=>d(!0)}),(0,a.jsx)(i,{title:"Ubicaciones",description:"Configurar y gestionar ubicaciones de almacenamiento.",icon:s.ZYm,color:"text-red-500",onClick:()=>u(!0)}),(0,a.jsx)(i,{title:"Motivos",description:"Administrar motivos de movimientos de inventario.",icon:s.sdT,color:"text-purple-500",onClick:()=>h(!0)}),(0,a.jsx)(i,{title:"Estados",description:"Configurar estados de art\xedculos y movimientos.",icon:s.O5k,color:"text-indigo-500",onClick:()=>g(!0)}),(0,a.jsx)(i,{title:"Modificaci\xf3n de Stock",description:"Editar o corregir art\xedculos en el inventario.",icon:s.uO9,color:"text-orange-500",onClick:()=>k(!0)}),(0,a.jsx)(i,{title:"Actualizar Stock M\xednimo",description:"Editar el stock m\xednimo de cada art\xedculo.",icon:s.hUO,color:"text-red-500",onClick:()=>N(!0)}),(0,a.jsx)(i,{title:"Administrar Personal",description:"Gestionar informaci\xf3n y roles del personal.",icon:s.p7b,color:"text-teal-500",onClick:()=>A(!0)})]}),(0,a.jsx)(p,{isOpen:e,onRequestClose:()=>t(!1)}),(0,a.jsx)(f,{isOpen:r,onRequestClose:()=>n(!1)}),(0,a.jsx)(j,{isOpen:c,onRequestClose:()=>d(!1)}),(0,a.jsx)(v,{isOpen:m,onRequestClose:()=>u(!1)}),(0,a.jsx)(E,{isOpen:x,onRequestClose:()=>h(!1)}),(0,a.jsx)(_,{isOpen:b,onRequestClose:()=>g(!1)}),(0,a.jsx)(z,{isOpen:y,onRequestClose:()=>N(!1)}),(0,a.jsx)(L,{isOpen:w,onRequestClose:()=>k(!1)}),(0,a.jsx)(B,{isOpen:S,onRequestClose:()=>A(!1)}),(0,a.jsx)(C.N9,{})]})]})}},46005:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>i});var a=r(52836),o=r(58168),s=r(96540),l=r(107);r(95852),r(40961),r(27003);var i=(0,s.forwardRef)(function(e,t){var r=(0,a.u)(e);return s.createElement(l.S,(0,o.A)({ref:t},r))})},29644:function(e,t,r){var a;a=function(e,t){"use strict";let r=[{key:"title",getter:e=>e.getTitle()},{key:"html",getter:e=>e.getHtmlContainer()},{key:"confirmButtonText",getter:e=>e.getConfirmButton()},{key:"denyButtonText",getter:e=>e.getDenyButton()},{key:"cancelButtonText",getter:e=>e.getCancelButton()},{key:"footer",getter:e=>e.getFooter()},{key:"closeButtonHtml",getter:e=>e.getCloseButton()},{key:"iconHtml",getter:e=>e.getIconContent()},{key:"loaderHtml",getter:e=>e.getLoader()}],a=()=>{};return function(o){function s(t){let a={},o={},s=r.map(e=>e.key);return Object.entries(t).forEach(t=>{let[r,l]=t;s.includes(r)&&e.isValidElement(l)?(a[r]=l,o[r]=" "):o[r]=l}),[a,o]}function l(e,a){Object.entries(a).forEach(a=>{let[s,l]=a,i=r.find(e=>e.key===s).getter(o),n=t.createRoot(i);n.render(l),e.__roots.push(n)})}function i(e){e.__roots.forEach(e=>{e.unmount()}),e.__roots=[]}return class extends o{static argsToParams(t){if(!(e.isValidElement(t[0])||e.isValidElement(t[1])))return o.argsToParams(t);{let e={};return["title","html","icon"].forEach((r,a)=>{void 0!==t[a]&&(e[r]=t[a])}),e}}_main(e,t){this.__roots=[],this.__params=Object.assign({},t,e);let[r,o]=s(this.__params),n=o.willOpen||a,c=o.didOpen||a,d=o.didDestroy||a;return super._main(Object.assign({},o,{willOpen:e=>{l(this,r),n(e)},didOpen:e=>{setTimeout(()=>{c(e)})},didDestroy:e=>{d(e),i(this)}}))}update(e){Object.assign(this.__params,e),i(this);let[t,r]=s(this.__params);super.update(r),l(this,t)}}}},e.exports=a(r(96540),r(5338))}},e=>{var t=t=>e(e.s=t);e.O(0,[563,615,356,23,706,312,365,636,593,792],()=>t(47362)),_N_E=e.O()}]);