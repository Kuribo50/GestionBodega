(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[598],{27250:(e,t,o)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/stock/prestamo",function(){return o(81301)}])},81301:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>w});var a=o(74848),r=o(96540),i=o(78465),n=o.n(i),s=o(46005),l=o(56598),c=o(20312),d=o.n(c),m=o(96365),u=o(91642),p=o(32885),x={cm:!0,mm:!0,in:!0,px:!0,pt:!0,pc:!0,em:!0,ex:!0,ch:!0,rem:!0,vw:!0,vh:!0,vmin:!0,vmax:!0,"%":!0};function g(e){var t=function(e){if("number"==typeof e)return{value:e,unit:"px"};var t,o=(e.match(/^[0-9.]*/)||"").toString();t=o.includes(".")?parseFloat(o):parseInt(o,10);var a=(e.match(/[^0-9]*$/)||"").toString();return x[a]?{value:t,unit:a}:(console.warn("React Spinners: ".concat(e," is not a valid css value. Defaulting to ").concat(t,"px.")),{value:t,unit:"px"})}(e);return"".concat(t.value).concat(t.unit)}var f=function(){return(f=Object.assign||function(e){for(var t,o=1,a=arguments.length;o<a;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},b=function(e,t){var o={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&0>t.indexOf(a)&&(o[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,a=Object.getOwnPropertySymbols(e);r<a.length;r++)0>t.indexOf(a[r])&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(o[a[r]]=e[a[r]]);return o},v=function(e,t,o){var a="react-spinners-".concat(e,"-").concat(o);if("undefined"==typeof window||!window.document)return a;var r=document.createElement("style");document.head.appendChild(r);var i=r.sheet,n="\n    @keyframes ".concat(a," {\n      ").concat(t,"\n    }\n  ");return i&&i.insertRule(n,0),a}("ClipLoader","0% {transform: rotate(0deg) scale(1)} 50% {transform: rotate(180deg) scale(0.8)} 100% {transform: rotate(360deg) scale(1)}","clip");let h=function(e){var t=e.loading,o=e.color,a=void 0===o?"#000000":o,i=e.speedMultiplier,n=e.cssOverride,s=e.size,l=void 0===s?35:s,c=b(e,["loading","color","speedMultiplier","cssOverride","size"]),d=f({background:"transparent !important",width:g(l),height:g(l),borderRadius:"100%",border:"2px solid",borderTopColor:a,borderBottomColor:"transparent",borderLeftColor:a,borderRightColor:a,display:"inline-block",animation:"".concat(v," ").concat(.75/(void 0===i?1:i),"s 0s infinite linear"),animationFillMode:"both"},void 0===n?{}:n);return void 0===t||t?r.createElement("span",f({style:d},c)):null};var y=o(77037),j=o(38869);function w(){let[e,t]=(0,r.useState)([]),[o,i]=(0,r.useState)([]),[c,x]=(0,r.useState)([]),[g,f]=(0,r.useState)([]),[b,v]=(0,r.useState)([]),[w,_]=(0,r.useState)([]),[N,S]=(0,r.useState)({}),[C,P]=(0,r.useState)(null),[M,k]=(0,r.useState)({tipoMovimiento:"Prestamo",fecha:new Date().toISOString().split("T")[0],motivo:""}),[O,A]=(0,r.useState)(!1),[E,D]=(0,r.useState)({correo_institucional:"",nombre:"",seccion:""}),[R,L]=(0,r.useState)(!1),[T,I]=(0,r.useState)(!1),[H,F]=(0,r.useState)(!1),[V,z]=(0,r.useState)(5),[q,B]=(0,r.useState)(""),[G,W]=(0,r.useState)("Todos"),[X,J]=(0,r.useState)(!1),Q=(0,r.useCallback)(e=>{let t=e.nombre||"Sin Nombre";return e.modelo_nombre&&null!==e.modelo_nombre&&(t+=" - Modelo: ".concat(e.modelo_nombre)),e.marca_nombre&&null!==e.marca_nombre&&(t+=" - Marca: ".concat(e.marca_nombre)),e.codigo_interno&&(t+=" - C\xf3digo Interno: ".concat(e.codigo_interno)),e.codigo_minvu&&(t+=" - C\xf3digo MINVU: ".concat(e.codigo_minvu)),e.numero_serie&&(t+=" - N\xba Serie: ".concat(e.numero_serie)),e.mac&&(t+=" - MAC: ".concat(e.mac)),t},[]),$=(0,r.useCallback)(e=>{let t={};b.forEach(o=>{if(o.personal_id===e){let e=Number(o.cantidad)||0;"Prestamo"===o.tipo_movimiento?t[o.articulo_id]=(t[o.articulo_id]||0)+e:"Regresado"===o.tipo_movimiento&&(t[o.articulo_id]=(t[o.articulo_id]||0)-e)}}),console.log("Pr\xe9stamos Netos para Personal ".concat(e,":"),t);let o=Object.keys(t).filter(e=>t[e]>0).map(e=>({articuloId:Number(e),cantidadPrestada:t[e]}));return console.log("Art\xedculos con pr\xe9stamos pendientes para Personal ".concat(e,":"),o),o},[b]),K=e=>{let t=Math.floor(e/6e4),o=Math.floor(e/36e5),a=Math.floor(e/864e5);return t<60?"".concat(t," minuto(s)"):o<24?"".concat(o," hora(s)"):"".concat(a," d\xeda(s)")},U=(0,r.useCallback)(async()=>{I(!0);try{let[e,o,a,r]=await Promise.all([(0,u.f2)(),(0,u._0)(),(0,u.HK)(),(0,u.J3)()]);console.log("Art\xedculos Obtenidos:",e);let i=e.filter(e=>e.stock_total>0||e.stock_prestado>0).map(e=>({label:Q(e),value:e.id,stock_total:e.stock_actual||0,stock_prestado:e.stock_prestado||0,prestado:(e.stock_prestado||0)>0,modelo_nombre:e.modelo_nombre||"Sin Modelo",marca_nombre:e.marca_nombre||"Sin Marca"}));t(i);let n=o.map(e=>({label:e.nombre,value:e.id}));x(n);let s=n.find(e=>"solicitud de personal"===e.label.toLowerCase());s&&k(e=>({...e,motivo:s.value}));let l=[...new Map(a.map(e=>[e.correo_institucional,e])).values()].map(e=>({label:"".concat(e.correo_institucional).concat(e.nombre?" - "+e.nombre:"").concat(e.seccion?" - "+e.seccion:" - Sin Secci\xf3n"),value:e.id,correo_institucional:e.correo_institucional||"Sin Correo",nombre:e.nombre||"Sin Nombre",seccion:e.seccion||"Sin Secci\xf3n"}));f(l),console.log("Movimientos Obtenidos:",r);let c=r.filter(e=>"Prestamo"===e.tipo_movimiento||"Regresado"===e.tipo_movimiento);console.log("Movimientos Filtrados:",c),c.sort((e,t)=>new Date(e.fecha)-new Date(t.fecha));let d={},m=[];c.forEach(e=>{let t=i.find(t=>t.value===e.articulo)||{},o=l.find(t=>t.value===e.personal)||{},a="".concat(e.articulo,"_").concat(e.personal);if("Prestamo"===e.tipo_movimiento)d[a]||(d[a]=[]),d[a].push({mov_id:e.id,cantidad_restante:e.cantidad,fecha_prestamo:e.fecha}),m.push({id:e.id,articulo_id:e.articulo,articulo:t.label||"Art\xedculo no encontrado",personal_id:e.personal,correo_institucional:o.correo_institucional||"Sin Correo",nombre:o.nombre||"Sin Nombre",seccion:o.seccion||"Sin Secci\xf3n",tipo_movimiento:"Prestamo",cantidad:e.cantidad||0,fecha_prestamo:new Date(e.fecha).toLocaleString(),fecha_regreso:"-",duracion:"A\xfan no se ha regresado"});else if("Regresado"===e.tipo_movimiento){if(d[a]&&d[a].length>0){let r=d[a].find(t=>t.cantidad_restante>=e.cantidad);if(r){let a=new Date(r.fecha_prestamo),i=new Date(e.fecha),n=K(i-a);r.cantidad_restante-=e.cantidad;let s=m.find(e=>e.id===r.mov_id);s&&(s.fecha_regreso=new Date(e.fecha).toLocaleString(),s.duracion=n),m.push({id:e.id,articulo_id:e.articulo,articulo:t.label||"Art\xedculo no encontrado",personal_id:e.personal,correo_institucional:o.correo_institucional||"Sin Correo",nombre:o.nombre||"Sin Nombre",seccion:o.seccion||"Sin Secci\xf3n",tipo_movimiento:"Regresado",cantidad:e.cantidad||0,fecha_prestamo:new Date(r.fecha_prestamo).toLocaleString(),fecha_regreso:new Date(e.fecha).toLocaleString(),duracion:n})}else m.push({id:e.id,articulo_id:e.articulo,articulo:t.label||"Art\xedculo no encontrado",personal_id:e.personal,correo_institucional:o.correo_institucional||"Sin Correo",nombre:o.nombre||"Sin Nombre",seccion:o.seccion||"Sin Secci\xf3n",tipo_movimiento:"Regresado",cantidad:e.cantidad||0,fecha_prestamo:"-",fecha_regreso:new Date(e.fecha).toLocaleString(),duracion:"No se encontr\xf3 el Prestamo"})}else m.push({id:e.id,articulo_id:e.articulo,articulo:t.label||"Art\xedculo no encontrado",personal_id:e.personal,correo_institucional:o.correo_institucional||"Sin Correo",nombre:o.nombre||"Sin Nombre",seccion:o.seccion||"Sin Secci\xf3n",tipo_movimiento:"Regresado",cantidad:e.cantidad||0,fecha_prestamo:"-",fecha_regreso:new Date(e.fecha).toLocaleString(),duracion:"No se encontr\xf3 el Prestamo"})}}),console.log("Historial Mapeado:",m),v(m)}catch(e){console.error("Error al cargar datos:",e),n().fire({icon:"error",title:"Error",text:"No se pudo cargar la informaci\xf3n."})}finally{I(!1)}},[Q]);(0,r.useEffect)(()=>{U()},[U]),(0,r.useEffect)(()=>{if(C){if("Prestamo"===M.tipoMovimiento)i(e.filter(e=>e.stock_total>0));else if("Regresado"===M.tipoMovimiento){let t=$(C.value),o=t.map(e=>e.articuloId),a={};t.forEach(e=>{a[e.articuloId]=e.cantidadPrestada}),i(e.filter(e=>o.includes(e.value)).map(e=>({...e,cantidadPrestada:a[e.value]||0})))}}else i([])},[C,M.tipoMovimiento,e,b,$]);let Y=async e=>{if(null==e?void 0:e.__isNew__)try{let t=await (0,u.B6)({nombre:e.label});x(e=>[...e,{label:t.nombre,value:t.id}]),k(e=>({...e,motivo:t.id})),n().fire({icon:"success",title:"\xc9xito",text:"Motivo creado correctamente."})}catch(e){console.error("Error al crear motivo:",e),n().fire({icon:"error",title:"Error",text:"Error al crear el motivo."})}else k(t=>({...t,motivo:e?e.value:""}))},Z=e=>{let{name:t,value:o}=e.target;D(e=>({...e,[t]:o}))},ee=(e,t)=>{S(o=>({...o,[e]:t}))},et=()=>{if(!C||0===w.length)return n().fire({icon:"warning",title:"Campos requeridos",text:"Todos los campos obligatorios deben estar completos."}),!1;for(let t of w){let o=N[t.value];if(!o||o<=0)return n().fire({icon:"warning",title:"Cantidad inv\xe1lida",text:'La cantidad para el art\xedculo "'.concat(t.label,'" debe ser un n\xfamero positivo.')}),!1;let a=e.find(e=>e.value===t.value);if(!a)return n().fire({icon:"error",title:"Error",text:'No se encontr\xf3 informaci\xf3n para el art\xedculo "'.concat(t.label,'".')}),!1;if("Prestamo"===M.tipoMovimiento){if(o>a.stock_total)return n().fire({icon:"warning",title:"Stock insuficiente",text:'No hay suficiente stock disponible para el art\xedculo "'.concat(t.label,'". Stock actual: ').concat(a.stock_total,".")}),!1}else if("Regresado"===M.tipoMovimiento){let e=t.cantidadPrestada||0;if(o>e)return n().fire({icon:"warning",title:"Cantidad excedida",text:'La cantidad a devolver para el art\xedculo "'.concat(t.label,'" excede la cantidad prestada por este personal. Cantidad prestada: ').concat(e,".")}),!1;let a=b.filter(e=>e.articulo_id===t.value&&e.personal_id===C.value&&"Prestamo"===e.tipo_movimiento&&"-"===e.fecha_regreso).sort((e,t)=>new Date(e.fecha_prestamo)-new Date(t.fecha_prestamo))[0];if(a){let e=new Date(a.fecha_prestamo);if(new Date(M.fecha)<e)return n().fire({icon:"warning",title:"Fecha inv\xe1lida",text:"La fecha de regreso no puede ser anterior a la fecha de pr\xe9stamo (".concat(a.fecha_prestamo,").")}),!1}}}return!0},eo=async e=>{if(e.preventDefault(),et()){L(!0),F(!0);try{var t;let e=M.motivo||(null===(t=c.find(e=>"solicitud de personal"===e.label.toLowerCase()))||void 0===t?void 0:t.value);for(let t of w){let o=N[t.value],a="Prestamo"===M.tipoMovimiento,r={articulo:t.value,tipo_movimiento:a?"Prestamo":"Regresado",cantidad:o,personal:C.value,motivo:e,fecha:new Date().toISOString()};console.log("Payload de Movimiento:",r);try{let e;a?(e=await (0,u.Sg)(r),console.log("Movimiento de Prestamo creado:",e)):(e=await (0,u.h2)(r),console.log("Movimiento de Regresado creado:",e))}catch(e){console.error('Error al registrar movimiento para el art\xedculo "'.concat(t.label,'":'),e),a?n().fire({icon:"error",title:"Error",text:'No se pudo registrar el pr\xe9stamo para el art\xedculo "'.concat(t.label,'".')}):n().fire({icon:"error",title:"Error",text:'No se pudo registrar la devoluci\xf3n para el art\xedculo "'.concat(t.label,'". Por favor, regrese los art\xedculos uno a uno.')})}}n().fire({icon:"success",title:"\xc9xito",text:"Movimiento registrado correctamente."}),k({tipoMovimiento:"Prestamo",fecha:new Date().toISOString().split("T")[0],motivo:""}),_([]),P(null),S({}),B(""),await U()}catch(e){console.error("Error al registrar movimiento:",e),n().fire({icon:"error",title:"Error",text:"No se pudo registrar el movimiento."})}finally{L(!1),F(!1)}}},ea=(0,r.useMemo)(()=>{let e=b;if("Todos"!==G&&(e=e.filter(e=>e.tipo_movimiento===G)),q){let t=q.toLowerCase();e=e.filter(e=>[e.articulo,e.correo_institucional,e.nombre,e.seccion,e.tipo_movimiento,e.cantidad.toString(),e.fecha_prestamo,e.fecha_regreso,e.duracion].some(e=>e.toLowerCase().includes(t)))}return e},[b,q,G]),er=(0,r.useMemo)(()=>[{Header:"Art\xedculo",accessor:"articulo"},{Header:"Correo Institucional",accessor:"correo_institucional"},{Header:"Nombre",accessor:"nombre"},{Header:"Secci\xf3n",accessor:"seccion"},{Header:"Tipo de Movimiento",accessor:"tipo_movimiento",Cell:e=>{let{row:t}=e,{tipo_movimiento:o}=t.original;return"Regresado"===o?(0,a.jsx)("span",{className:"text-green-500 font-semibold flex items-center",children:"Regresado"}):(0,a.jsx)("span",{className:"text-blue-500 font-semibold flex items-center",children:"Prestamo"})}},{Header:"Cantidad",accessor:"cantidad"},{Header:"Fecha de Pr\xe9stamo",accessor:"fecha_prestamo"},{Header:"Fecha de Regreso",accessor:"fecha_regreso"},{Header:"Duraci\xf3n",accessor:"duracion"}],[]),{getTableProps:ei,getTableBodyProps:en,headerGroups:es,prepareRow:el,page:ec,canPreviousPage:ed,canNextPage:em,pageOptions:eu,state:{pageIndex:ep,pageSize:ex},gotoPage:eg,nextPage:ef,previousPage:eb,setPageSize:ev}=(0,p.useTable)({columns:er,data:ea,initialState:{pageIndex:0,pageSize:"Todos"===V?ea.length:V,sortBy:[{id:"fecha_prestamo",desc:!0}]},manualPagination:!1},p.useSortBy,p.usePagination);return(0,r.useEffect)(()=>{"Todos"===V?ev(ea.length):ev(V)},[V,ev,ea.length]),(0,a.jsxs)("div",{className:"flex bg-gray-100 min-h-screen",children:[(0,a.jsx)("div",{className:"md:hidden fixed top-4 left-4 z-50",children:(0,a.jsx)("button",{onClick:()=>J(!X),className:"text-gray-700 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500","aria-label":"Abrir men\xfa",children:(0,a.jsx)(j.ND1,{size:24})})}),(0,a.jsx)(m.A,{isOpen:X,onClose:()=>J(!1)}),(0,a.jsxs)("main",{className:"flex-1 p-4 md:p-6 lg:p-8 overflow-auto ml-0 md:ml-64",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-6 text-gray-800 text-center sm:text-left",children:"Pr\xe9stamos y Devoluciones"}),(0,a.jsxs)("form",{onSubmit:eo,className:"bg-white p-6 rounded-lg shadow-lg space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 items-end",children:[(0,a.jsxs)("div",{className:"sm:col-span-2",children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Personal ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)(s.Ay,{options:g,value:C,onChange:e=>{P(e),k(e=>({...e,motivo:""})),_([]),S({})},placeholder:"Seleccionar Personal",isClearable:!0,instanceId:"select-personal"})]}),(0,a.jsx)("div",{children:(0,a.jsxs)("button",{type:"button",onClick:()=>A(!0),className:"w-full sm:w-auto px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors duration-300 flex items-center justify-center space-x-2",children:[(0,a.jsx)(y.OiG,{}),(0,a.jsx)("span",{children:"Agregar Personal"})]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tipo de Movimiento ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)(s.Ay,{options:[{label:"Pr\xe9stamo",value:"Prestamo"},{label:"Regresado",value:"Regresado"}],value:{label:M.tipoMovimiento,value:M.tipoMovimiento},onChange:e=>k(t=>({...t,tipoMovimiento:e.value,motivo:""})),placeholder:"Seleccionar Tipo de Movimiento",instanceId:"select-tipo-movimiento"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Motivo"}),(0,a.jsx)(l.A,{options:c,onChange:Y,placeholder:"Seleccionar o Crear Motivo",isClearable:!0,instanceId:"create-motivo"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Fecha de"," ","Prestamo"===M.tipoMovimiento?"Pr\xe9stamo":"Regreso"," ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)("input",{type:"date",value:M.fecha,onChange:e=>k(t=>({...t,fecha:e.target.value})),max:new Date().toISOString().split("T")[0],className:"w-full px-4 py-2 border rounded-md focus:ring-blue-500 focus:border-blue-500",required:!0})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Art\xedculos ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)(s.Ay,{isMulti:!0,options:o,value:w,onChange:e=>{_(e||[]);let t={};(e||[]).forEach(e=>{"Regresado"===M.tipoMovimiento&&e.cantidadPrestada?t[e.value]=Math.min(N[e.value]||1,e.cantidadPrestada):t[e.value]=N[e.value]||1}),S(t)},placeholder:"Prestamo"===M.tipoMovimiento?"Seleccionar Art\xedculos para Prestar":"Seleccionar Art\xedculos para Devolver",instanceId:"select-articulos",formatOptionLabel:e=>(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{children:e.label}),(0,a.jsx)("span",{className:"ml-2 text-xs text-gray-500",children:"Prestamo"===M.tipoMovimiento?"Stock Disponible: ".concat(e.stock_total):"Cantidad Prestada: ".concat(e.cantidadPrestada)})]})}),w.length>0&&(0,a.jsx)("div",{className:"mt-4 space-y-2",children:w.map(e=>(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center p-2 rounded-md ".concat("Prestamo"===M.tipoMovimiento?"bg-red-100":"bg-green-100"),children:[(0,a.jsx)("span",{className:"text-sm",children:e.label}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 mt-2 md:mt-0",children:[(0,a.jsx)("label",{className:"text-sm text-gray-700",children:"Cantidad:"}),(0,a.jsx)("input",{type:"number",value:N[e.value]||1,min:"1",max:"Prestamo"===M.tipoMovimiento?e.stock_total:e.cantidadPrestada,onChange:t=>ee(e.value,parseInt(t.target.value,10)),className:"w-20 px-2 py-1 border rounded-md focus:ring-blue-500 focus:border-blue-500",required:!0})]})]},e.value))})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-end space-y-4 sm:space-y-0 sm:space-x-4",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>{k({tipoMovimiento:"Prestamo",fecha:new Date().toISOString().split("T")[0],motivo:""}),_([]),P(null),S({}),B(""),W("Todos")},className:"w-full sm:w-auto px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors duration-300 flex items-center justify-center space-x-2",children:[(0,a.jsx)(y.QCr,{}),(0,a.jsx)("span",{children:"Cancelar"})]}),(0,a.jsx)("button",{type:"submit",disabled:R||H,className:"w-full sm:w-auto px-4 py-2 text-white rounded-md ".concat(R||H?"bg-gray-500 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"," flex items-center justify-center space-x-2"),children:R||H?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h,{size:20,color:"#ffffff",loading:!0}),(0,a.jsx)("span",{children:"Registrando..."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y.CMH,{}),(0,a.jsx)("span",{children:"Registrar Movimiento"})]})})]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg space-y-6 mt-6 overflow-x-auto",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold mb-4 text-gray-700",children:"Historial de Movimientos"}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4",children:[(0,a.jsx)("div",{className:"flex items-center space-x-2 mb-2 sm:mb-0 w-full sm:w-1/2",children:(0,a.jsx)("input",{type:"text",placeholder:"Buscar en todos los campos...",value:q,onChange:e=>B(e.target.value),className:"w-full px-4 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-lg"})}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("label",{className:"text-sm text-gray-700 flex items-center",children:"Mostrar:"}),(0,a.jsx)(s.Ay,{options:[5,10,20,"Todos"].map(e=>({label:"number"==typeof e?"".concat(e):e,value:e})),value:"number"==typeof V?{label:"".concat(V),value:V}:{label:V,value:V},onChange:e=>{z(e.value)},placeholder:"Seleccionar",isClearable:!1,className:"w-24",instanceId:"select-items-per-page"}),(0,a.jsx)(s.Ay,{options:[{label:"Todos",value:"Todos"},{label:"Pr\xe9stamos",value:"Prestamo"},{label:"Devoluciones",value:"Regresado"}],value:"Todos"===G?{label:"Todos",value:"Todos"}:"Prestamo"===G?{label:"Pr\xe9stamos",value:"Prestamo"}:{label:"Devoluciones",value:"Regresado"},onChange:e=>W(e.value),placeholder:"Tipo de Movimiento",isClearable:!1,className:"w-40",instanceId:"select-tipo-movimiento-filtro"})]})]}),T||H?(0,a.jsx)("div",{className:"flex justify-center items-center h-32",children:(0,a.jsx)(h,{size:50,color:"#4A90E2",loading:!0})}):(0,a.jsx)(a.Fragment,{children:0===ea.length?(0,a.jsx)("p",{className:"text-center text-gray-500",children:"No hay movimientos registrados."}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{...ei(),className:"min-w-full border-collapse border border-gray-300 rounded-lg shadow-md bg-white text-sm",children:[(0,a.jsx)("thead",{className:"bg-gray-200 text-gray-700 uppercase text-sm",children:es.map(e=>(0,r.createElement)("tr",{...e.getHeaderGroupProps(),key:e.id},e.headers.map(e=>(0,r.createElement)("th",{...e.getHeaderProps(e.getSortByToggleProps()),key:e.id,className:"py-2 px-4 border border-gray-300 text-left tracking-wider font-semibold"},(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{children:e.render("Header")}),(0,a.jsx)("span",{className:"ml-2",children:e.isSorted?e.isSortedDesc?(0,a.jsx)(y.GOR,{className:"text-gray-600"}):(0,a.jsx)(y.XhJ,{className:"text-gray-600"}):(0,a.jsx)(y.MjW,{className:"text-gray-600"})})]})))))}),(0,a.jsx)("tbody",{...en(),className:"text-gray-700",children:ec.map(e=>(el(e),(0,r.createElement)("tr",{...e.getRowProps(),key:e.id,className:"hover:bg-gray-100 transition-all duration-150"},e.cells.map(e=>(0,r.createElement)("td",{...e.getCellProps(),key:e.column.id,className:"py-2 px-4 border border-gray-300"},e.render("Cell"))))))})]})}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center mt-4 text-sm",children:[(0,a.jsxs)("div",{className:"flex space-x-2 mb-2 sm:mb-0",children:[(0,a.jsx)("button",{onClick:()=>eg(0),disabled:!ed,className:"px-3 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors ".concat(ed?"":"bg-gray-300 cursor-not-allowed"),title:"Primera P\xe1gina",children:(0,a.jsx)(j.kRp,{})}),(0,a.jsx)("button",{onClick:()=>eb(),disabled:!ed,className:"px-3 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors ".concat(ed?"":"bg-gray-300 cursor-not-allowed"),title:"P\xe1gina Anterior",children:(0,a.jsx)(j.kRp,{})}),(0,a.jsx)("button",{onClick:()=>ef(),disabled:!em,className:"px-3 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors ".concat(em?"":"bg-gray-300 cursor-not-allowed"),title:"P\xe1gina Siguiente",children:(0,a.jsx)(j.dyV,{})}),(0,a.jsx)("button",{onClick:()=>eg(eu.length-1),disabled:!em,className:"px-3 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors ".concat(em?"":"bg-gray-300 cursor-not-allowed"),title:"\xdaltima P\xe1gina",children:(0,a.jsx)(j.dyV,{})})]}),(0,a.jsxs)("span",{className:"text-gray-700 mb-2 sm:mb-0",children:["P\xe1gina ",(0,a.jsx)("strong",{children:ep+1})," de"," ",(0,a.jsx)("strong",{children:eu.length})]}),(0,a.jsx)("div",{className:"flex items-center space-x-2"})]})]})})]}),(0,a.jsx)(d(),{isOpen:O,onRequestClose:()=>A(!1),contentLabel:"Agregar Nueva Persona",className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center px-4 sm:px-6 lg:px-8",overlayClassName:"fixed inset-0 bg-gray-600 bg-opacity-50",children:(0,a.jsxs)("div",{className:"bg-white p-6 sm:p-8 lg:p-10 rounded-lg shadow-lg w-full max-w-md sm:max-w-lg space-y-6",children:[(0,a.jsxs)("h2",{className:"text-xl sm:text-2xl lg:text-3xl font-bold flex items-center mb-4",children:[(0,a.jsx)(y.OiG,{className:"mr-2"}),"Agregar Nueva Persona"]}),(0,a.jsxs)("form",{onSubmit:async e=>{e.preventDefault();let{correo_institucional:t,nombre:o,seccion:a}=E;if(!t){n().fire({icon:"warning",title:"Correo requerido",text:"Por favor, ingresa el correo institucional."});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)){n().fire({icon:"warning",title:"Correo inv\xe1lido",text:"Por favor, ingresa un correo institucional v\xe1lido."});return}try{let e={correo_institucional:t,nombre:""===o.trim()?null:o,seccion:""===a.trim()?null:a},r=await (0,u.fN)(e),i={label:"".concat(r.correo_institucional).concat(r.nombre?" - "+r.nombre:"").concat(r.seccion?" - "+r.seccion:" - Sin Secci\xf3n"),value:r.id,correo_institucional:r.correo_institucional||"Sin Correo",nombre:r.nombre||"Sin Nombre",seccion:r.seccion||"Sin Secci\xf3n"};f(e=>[...e,i]),P(i),D({correo_institucional:"",nombre:"",seccion:""}),A(!1),n().fire({icon:"success",title:"\xc9xito",text:"Persona agregada correctamente."})}catch(e){console.error("Error al crear persona:",e),n().fire({icon:"error",title:"Error",text:"No se pudo crear la persona."})}},className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Correo Institucional ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{type:"email",name:"correo_institucional",value:E.correo_institucional,onChange:Z,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-base",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre"}),(0,a.jsx)("input",{type:"text",name:"nombre",value:E.nombre,onChange:Z,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-base"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Secci\xf3n"}),(0,a.jsx)("input",{type:"text",name:"seccion",value:E.seccion,onChange:Z,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 text-base"})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-end space-y-4 sm:space-y-0 sm:space-x-4",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>A(!1),className:"w-full sm:w-auto px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition-colors duration-300 flex items-center justify-center space-x-2",children:[(0,a.jsx)(y.QCr,{}),(0,a.jsx)("span",{children:"Cancelar"})]}),(0,a.jsxs)("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors duration-300 flex items-center justify-center space-x-2",children:[(0,a.jsx)(y.CMH,{}),(0,a.jsx)("span",{children:"Agregar"})]})]})]})]})})]})]})}d().setAppElement("#__next")},56598:(e,t,o)=>{"use strict";o.d(t,{A:()=>x});var a=o(58168),r=o(96540),i=o(107),n=o(52836),s=o(89379),l=o(64241),c=o(82305),d=o(49164),m=["allowCreateWhileLoading","createOptionPosition","formatCreateLabel","isValidNewOption","getNewOptionData","onCreateOption","options","onChange"],u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,a=String(e).toLowerCase(),r=String(o.getOptionValue(t)).toLowerCase(),i=String(o.getOptionLabel(t)).toLowerCase();return r===a||i===a},p={formatCreateLabel:function(e){return'Create "'.concat(e,'"')},isValidNewOption:function(e,t,o,a){return!(!e||t.some(function(t){return u(e,t,a)})||o.some(function(t){return u(e,t,a)}))},getNewOptionData:function(e,t){return{label:t,value:e,__isNew__:!0}}};o(40961),o(27003);var x=(0,r.forwardRef)(function(e,t){var o,u,x,g,f,b,v,h,y,j,w,_,N,S,C,P,M,k,O,A,E,D,R,L,T,I,H,F,V=(x=void 0!==(u=(o=(0,n.u)(e)).allowCreateWhileLoading)&&u,f=void 0===(g=o.createOptionPosition)?"last":g,v=void 0===(b=o.formatCreateLabel)?p.formatCreateLabel:b,y=void 0===(h=o.isValidNewOption)?p.isValidNewOption:h,w=void 0===(j=o.getNewOptionData)?p.getNewOptionData:j,_=o.onCreateOption,S=void 0===(N=o.options)?[]:N,C=o.onChange,k=void 0===(M=(P=(0,c.A)(o,m)).getOptionValue)?i.g:M,A=void 0===(O=P.getOptionLabel)?i.b:O,E=P.inputValue,D=P.isLoading,R=P.isMulti,L=P.value,T=P.name,I=(0,r.useMemo)(function(){return y(E,(0,d.H)(L),S,{getOptionValue:k,getOptionLabel:A})?w(E,v(E)):void 0},[v,w,A,k,E,y,S,L]),H=(0,r.useMemo)(function(){return(x||!D)&&I?"first"===f?[I].concat((0,l.A)(S)):[].concat((0,l.A)(S),[I]):S},[x,f,D,I,S]),F=(0,r.useCallback)(function(e,t){if("select-option"!==t.action)return C(e,t);var o=Array.isArray(e)?e:[e];if(o[o.length-1]===I){if(_)_(E);else{var a=w(E,E);C((0,d.D)(R,[].concat((0,l.A)((0,d.H)(L)),[a]),a),{action:"create-option",name:T,option:a})}return}C(e,t)},[w,E,R,T,I,_,C,L]),(0,s.A)((0,s.A)({},P),{},{options:H,onChange:F}));return r.createElement(i.S,(0,a.A)({ref:t},V))})},46005:(e,t,o)=>{"use strict";o.d(t,{Ay:()=>s});var a=o(52836),r=o(58168),i=o(96540),n=o(107);o(95852),o(40961),o(27003);var s=(0,i.forwardRef)(function(e,t){var o=(0,a.u)(e);return i.createElement(n.S,(0,r.A)({ref:t},o))})}},e=>{var t=t=>e(e.s=t);e.O(0,[563,465,615,356,23,706,312,885,365,636,593,792],()=>t(27250)),_N_E=e.O()}]);